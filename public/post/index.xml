<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts | Kristian Brock</title>
    <link>https://www.kristianbrock.com/post/</link>
      <atom:link href="https://www.kristianbrock.com/post/index.xml" rel="self" type="application/rss+xml" />
    <description>Posts</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language>
    <image>
      <url>https://www.kristianbrock.com/img/icon-192.png</url>
      <title>Posts</title>
      <link>https://www.kristianbrock.com/post/</link>
    </image>
    
    <item>
      <title>New phase I methods in escalation</title>
      <link>https://www.kristianbrock.com/post/new-phase1-escalation-methods/</link>
      <pubDate>Tue, 20 Oct 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/new-phase1-escalation-methods/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;This week I updated the &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34;&gt;&lt;code&gt;escalation&lt;/code&gt;&lt;/a&gt; &lt;span class=&#34;citation&#34;&gt;(Brock 2020)&lt;/span&gt; package on CRAN with new methods to implement several phase I and phase I/II dose-finding designs.
This post describes the addition of the phase I methods TPI, mTPI, and the logistic model method of &lt;span class=&#34;citation&#34;&gt;Neuenschwander, Branson, and Gsponer (2008)&lt;/span&gt;, and also the addition of MCMC-based CRM methods.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;tpi&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;TPI&lt;/h2&gt;
&lt;p&gt;The toxicity probability interval (TPI) design was introduced by &lt;span class=&#34;citation&#34;&gt;Ji, Li, and Bekele (2007)&lt;/span&gt;.
It is one of a series of dose-finding trial designs that works by partitioning the probability of toxicity into a set of intervals.
These designs make dose-selection decisions that are determined by the interval in which the probability of toxicity for the current dose is believed to reside.&lt;/p&gt;
&lt;p&gt;Core to this design is a beta-binomial Bayesian conjugate model.
For hyperparameters &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, let the probability of toxicity at dose &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; be &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt;, with prior distribution&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[p_i \sim Beta(\alpha, \beta).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(n_i\)&lt;/span&gt; patients have been treated at dose &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;, yielding &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; toxicity events, the posterior distribution is&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ p_i | data \sim Beta(\alpha + x_{i}, \beta + n_{i} - x_{i}).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Using this distribution, let the standard deviation of &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; be denoted by &lt;span class=&#34;math inline&#34;&gt;\(\sigma_i\)&lt;/span&gt;.
The design seeks a dose with probability of toxicity close to some pre-specified target level, &lt;span class=&#34;math inline&#34;&gt;\(p_T\)&lt;/span&gt;.
The entire range of possible values for &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; can be broken up into the following intervals:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The underdosing interval (UI), defined as &lt;span class=&#34;math inline&#34;&gt;\((0, p_{T} - K_{2} \sigma_{i})\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;The equivalence interval (EI), defined as &lt;span class=&#34;math inline&#34;&gt;\((p_{T} - K_{2} \sigma_{i}, p_{T} + K_{1} \sigma_{i})\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;The overdosing interval (OI), defined as &lt;span class=&#34;math inline&#34;&gt;\((p_{T} + K_{1} \sigma_{i}, 1)\)&lt;/span&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;for pre-specified model constants, &lt;span class=&#34;math inline&#34;&gt;\(K_1, K_2\)&lt;/span&gt;.
These intervals are mutally-exclusive and mutually-exhaustive, meaning that every possible probability belongs to precisely one of them.
In other words, these intervals form a partition of the probability space, &lt;span class=&#34;math inline&#34;&gt;\((0, 1)\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Using the posterior distribution, we can calculate the three probabilities&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[p_{UI} = Pr(p_i \in \text{UI}), \enspace p_{EI} = Pr(p_i \in \text{EI}), \enspace p_{OI} = Pr(p_i \in \text{OI}).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;By definition, &lt;span class=&#34;math inline&#34;&gt;\(p_{UI} + p_{EI} + p_{OI} = 1\)&lt;/span&gt;.
The logical action in the dose-finding trial depends on which of these three probabilities is the greatest.
If &lt;span class=&#34;math inline&#34;&gt;\(p_{UI} &amp;gt; p_{EI}, p_{OI}\)&lt;/span&gt;, then the current dose is likely an underdose, so our desire should be to escalate dose to &lt;span class=&#34;math inline&#34;&gt;\(i+1\)&lt;/span&gt;.
In contrast, if &lt;span class=&#34;math inline&#34;&gt;\(p_{OI} &amp;gt; p_{UI}, p_{EI}\)&lt;/span&gt;, then the current dose is likely an overdose and we will want to de-escalate dose to &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; for the next patient.
If &lt;span class=&#34;math inline&#34;&gt;\(p_{EI} &amp;gt; p_{UI}, p_{OI}\)&lt;/span&gt;, then the current dose is deemed sufficiently close to &lt;span class=&#34;math inline&#34;&gt;\(p_T\)&lt;/span&gt; and we will want to stay at dose-level &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Further to these rules regarding dose-selection, the following rule is used to avoid recommending dangerous doses.
A dose is deemed inadmissible for being excessively toxic if&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ Pr(p_{i} &amp;gt; p_{T} | data) &amp;gt; \xi,\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;for a certainty threshold, &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt;.
If a dose is excluded by this rule, it should not be recommended by the model.
Irrespective the probabilities &lt;span class=&#34;math inline&#34;&gt;\(p_{UI}, p_{EI}, p_{OI}\)&lt;/span&gt;, the design will recommend to stay at dose &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; rather than escalate to a dose previously identified as being inadmissible.
Furthermore, the design will advocate stopping if the lowest dose is inferred to be inadmissible.&lt;/p&gt;
&lt;p&gt;In their paper, the authors demonstrate acceptable operating performance using &lt;span class=&#34;math inline&#34;&gt;\(\alpha = \beta = 0.005\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(K_{1} = 1\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(K_{2} = 1.5\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\xi = 0.95\)&lt;/span&gt;.
See &lt;span class=&#34;citation&#34;&gt;Ji, Li, and Bekele (2007)&lt;/span&gt; for full details.&lt;/p&gt;
&lt;div id=&#34;implementation-in-escalation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Implementation in &lt;code&gt;escalation&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Let us specify the model that the authors investigate in their publication:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(escalation)

model &amp;lt;- get_tpi(num_doses = 5, target = 0.3, alpha = 0.005, beta = 0.005, 
                 k1 = 1, k2 = 1.5, exclusion_certainty = 0.95)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As with all models in &lt;code&gt;escalation&lt;/code&gt;, we fit the model to some outcomes using code like:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;1NNT&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and learn the dose recommended for the next patient(s):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In their Table 1, &lt;span class=&#34;citation&#34;&gt;Ji, Li, and Bekele (2007)&lt;/span&gt; recommend some model choices based on notional cohort outcomes.
We can reproduce their findings using, for example:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- model %&amp;gt;% 
  get_dose_paths(cohort_sizes = 6, next_dose = 2)

library(dplyr)
as_tibble(paths) %&amp;gt;% 
  select(outcomes, next_dose) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;outcomes&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;next_dose&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNNNN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNNNT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNNTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNTTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NTTTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTTTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;I.e. if there are six patients at the current dose, this particular parameterisation will only advocate escalation if exactly zero toxicities are seen.
If one or two toxicities are seen, the design advocates staying at dose 2, otherwise deescalation is recommended.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;mtpi&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;mTPI&lt;/h2&gt;
&lt;p&gt;The modified toxicity probability interval (mTPI) design was introduced by &lt;span class=&#34;citation&#34;&gt;Ji et al. (2010)&lt;/span&gt;.
As the name suggests, it is a modification of the earlier TPI design.
mTPI is very similar to TPI, again using a method that partitions the probability of toxicity into a set of intervals.&lt;/p&gt;
&lt;p&gt;This design uses a beta-binomial Bayesian conjugate model.
For hyperparameters &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;, let the probability of toxicity at dose &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; be &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt;, with prior distribution&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[p_i \sim Beta(\alpha, \beta).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(n_i\)&lt;/span&gt; patients have been treated at dose &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;, yielding &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; toxicity events, the posterior distribution is&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ p_i | data \sim Beta(\alpha + x_{i}, \beta + n_{i} - x_{i}).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The design seeks a dose with probability of toxicity close to some pre-specified target level, &lt;span class=&#34;math inline&#34;&gt;\(p_T\)&lt;/span&gt;.
The entire range of possible values for &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; can be broken up into the following intervals:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The underdosing interval (UI), defined as &lt;span class=&#34;math inline&#34;&gt;\((0, p_{T} - \epsilon_{1})\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;The equivalence interval (EI), defined as &lt;span class=&#34;math inline&#34;&gt;\((p_{T} - \epsilon_{1}, p_{T} + \epsilon_{2})\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;The overdosing interval (OI), defined as &lt;span class=&#34;math inline&#34;&gt;\((p_{T} + \epsilon_{2}, 1)\)&lt;/span&gt;;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;for pre-specified model constants, &lt;span class=&#34;math inline&#34;&gt;\(\epsilon_{1}, \epsilon_{2}\)&lt;/span&gt;.
These intervals are mutally-exclusive and mutually-exhaustive, meaning that every possible probability belongs to precisely one of them.
In other words, these intervals form a partition of the probability space, &lt;span class=&#34;math inline&#34;&gt;\((0, 1)\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;For a continuous random variable &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; with cumulative probability mass function &lt;span class=&#34;math inline&#34;&gt;\(F(x)\)&lt;/span&gt; (i.e. &lt;span class=&#34;math inline&#34;&gt;\(Pr(X &amp;lt; x) = F(x)\)&lt;/span&gt;), the authors define the unit probability mass (UPM) for an interval &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; to be &lt;span class=&#34;math inline&#34;&gt;\((F(b) - F(a)) / (b - a)\)&lt;/span&gt;.
That is, the UPM is the probability mass in an interval divided by the width of the interval, and can be interpreted as the average probability density of the interval.&lt;/p&gt;
&lt;p&gt;Then, using the posterior distribution identified above, we calculate the three UPMs&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[UPM_{UI} = Pr(p_i \in \text{UI}) / (p_{T} - \epsilon_{1}),\]&lt;/span&gt;
&lt;span class=&#34;math display&#34;&gt;\[UPM_{EI} = Pr(p_i \in \text{EI}) / (\epsilon_{1} + \epsilon_{2}),\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[UPM_{OI} = Pr(p_i \in \text{OI}) / (1 - p_{T} + \epsilon_{2}).\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The logical action in the dose-finding trial depends on which of these three quantities is the greatest.
If &lt;span class=&#34;math inline&#34;&gt;\(UPM_{UI} &amp;gt; UPM_{EI}, UPM_{OI}\)&lt;/span&gt;, then the current dose is likely an underdose, so our desire should be to escalate dose to &lt;span class=&#34;math inline&#34;&gt;\(i+1\)&lt;/span&gt;.
In contrast, if &lt;span class=&#34;math inline&#34;&gt;\(UPM_{OI} &amp;gt; UPM_{UI}, UPM_{EI}\)&lt;/span&gt;, then the current dose is likely an overdose and we will want to de-escalate dose to &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; for the next patient.
If &lt;span class=&#34;math inline&#34;&gt;\(UPM_{EI} &amp;gt; UPM_{UI}, UPM_{OI}\)&lt;/span&gt;, then the current dose is deemed sufficiently close to &lt;span class=&#34;math inline&#34;&gt;\(p_T\)&lt;/span&gt; and we will want to stay at dose-level &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Further to these rules regarding dose-selection, the following rule is used to avoid recommending dangerous doses.
A dose is deemed inadmissible for being excessively toxic if&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ Pr(p_{i} &amp;gt; p_{T} | data) &amp;gt; \xi,\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;for a certainty threshold, &lt;span class=&#34;math inline&#34;&gt;\(\xi\)&lt;/span&gt;.
If a dose is excluded by this rule, it should not be recommended by the model.
Irrespective the values of &lt;span class=&#34;math inline&#34;&gt;\(UPM_{UI}, UPM_{EI}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(UPM_{OI}\)&lt;/span&gt;, the design will recommend to stay at dose &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; rather than escalate to a dose previously identified as being inadmissible.
Furthermore, the design will advocate stopping if the lowest dose is inferred to be inadmissible.&lt;/p&gt;
&lt;p&gt;In their paper, the authors demonstrate acceptable operating performance using &lt;span class=&#34;math inline&#34;&gt;\(\alpha = \beta = 1\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\epsilon_{1} = 0.05\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\epsilon_{2} = 0.05\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\xi = 0.95\)&lt;/span&gt;.
See &lt;span class=&#34;citation&#34;&gt;Ji et al. (2010)&lt;/span&gt; for full details.&lt;/p&gt;
&lt;div id=&#34;implementation-in-escalation-1&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Implementation in &lt;code&gt;escalation&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Again, let us investigate one of the parameterisations that the authors investigate in their publication:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(escalation)

model &amp;lt;- get_mtpi(num_doses = 5, target = 0.3, alpha = 1, beta = 1, 
                  epsilon1 = 0.05, epsilon2 = 0.05, exclusion_certainty = 0.95)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As before, we fit the model and learn the dose recommended for the next patient(s) using:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;1NNT&amp;#39;) 
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In their Figure 2, the authors again enumerate model advice over a range of cohort outputs.
Just as we did with TPI, enumerating the dose recommendations after a cohort of 6 has been treated at dose 2:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- model %&amp;gt;% 
  get_dose_paths(cohort_sizes = 6, next_dose = 2)

as_tibble(paths) %&amp;gt;% 
  select(outcomes, next_dose) %&amp;gt;% 
  knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;outcomes&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;next_dose&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNNNN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNNNT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNNTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNNTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NNTTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NTTTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TTTTTT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We see that after &lt;code&gt;2NNNNNT&lt;/code&gt;, the mTPI advocates escalation whereas TPI advocated sticking at dose 2.
The advice from the two models matches in all other outcomes in this particular example.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;neuenschwander-et-al.&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Neuenschwander &lt;em&gt;et al.&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34;&gt;Neuenschwander, Branson, and Gsponer (2008)&lt;/span&gt; (NBG) introduced a derivative of the CRM for dose-escalation clinical trials using the model:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ \text{logit} p_i = \alpha + \exp{(\beta)} \log{(x_i / d^*)}, \]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; is the probability of toxicity at the &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;th dose, &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt;, and &lt;span class=&#34;math inline&#34;&gt;\(d^*\)&lt;/span&gt; is a reference dose.
Here &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; are model parameters on which the authors place a bivariate normal prior.
This model is very similar to the two-parameter logistic CRM.
However, a notable difference is that the dose, &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt;, enters the model as a covariate.
This dispenses with the toxicity skeleton that is used in the CRM.&lt;/p&gt;
&lt;div id=&#34;implementation-in-escalation-2&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Implementation in &lt;code&gt;escalation&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;The heavy lifting required to fit the model is performed by &lt;code&gt;trialr&lt;/code&gt; and &lt;code&gt;rstan&lt;/code&gt;.
&lt;code&gt;escalation&lt;/code&gt; merely composes the model fit in such a way that it can be used with the other dose-selection modules.&lt;/p&gt;
&lt;p&gt;For illustration, let us reproduce the analysis in &lt;span class=&#34;citation&#34;&gt;Neuenschwander, Branson, and Gsponer (2008)&lt;/span&gt; that the authors used to demonstrate the flexibility of a two-parameter approach.
In a trial of 15 doses, the investigators saw outcomes:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(escalation)

dose &amp;lt;- c(1, 2.5, 5, 10, 15, 20, 25, 30, 40, 50, 75, 100, 150, 200, 250)
outcomes &amp;lt;- &amp;#39;1NNN 2NNNN 3NNNN 4NNNN 7TT&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creating a dose-escalation model with NBG’s parameters:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- get_trialr_nbg(real_doses = dose, d_star = 250, target = 0.3,
                        alpha_mean = 2.15, alpha_sd = 0.84,
                        beta_mean = 0.52, beta_sd = 0.8,
                        seed = 2020)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and fitting the model to the observed outcomes:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(outcomes)
fit&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Patient-level data:
## # A tibble: 17 x 4
##    Patient Cohort  Dose   Tox
##      &amp;lt;int&amp;gt;  &amp;lt;int&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt;
##  1       1      1     1     0
##  2       2      1     1     0
##  3       3      1     1     0
##  4       4      2     2     0
##  5       5      2     2     0
##  6       6      2     2     0
##  7       7      2     2     0
##  8       8      3     3     0
##  9       9      3     3     0
## 10      10      3     3     0
## 11      11      3     3     0
## 12      12      4     4     0
## 13      13      4     4     0
## 14      14      4     4     0
## 15      15      4     4     0
## 16      16      5     7     1
## 17      17      5     7     1
## 
## Dose-level data:
## # A tibble: 15 x 7
##    RealDose  dose   tox     n empiric_tox_rate mean_prob_tox median_prob_tox
##       &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt;            &amp;lt;dbl&amp;gt;         &amp;lt;dbl&amp;gt;           &amp;lt;dbl&amp;gt;
##  1      1       1     0     3                0        0.0117         0.00511
##  2      2.5     2     0     4                0        0.0306         0.0186 
##  3      5       3     0     4                0        0.0644         0.0468 
##  4     10       4     0     4                0        0.134          0.114  
##  5     15       5     0     0              NaN        0.202          0.185  
##  6     20       6     0     0              NaN        0.264          0.251  
##  7     25       7     2     2                1        0.322          0.314  
##  8     30       8     0     0              NaN        0.374          0.370  
##  9     40       9     0     0              NaN        0.463          0.466  
## 10     50      10     0     0              NaN        0.535          0.543  
## 11     75      11     0     0              NaN        0.662          0.678  
## 12    100      12     0     0              NaN        0.741          0.760  
## 13    150      13     0     0              NaN        0.829          0.849  
## 14    200      14     0     0              NaN        0.875          0.894  
## 15    250      15     0     0              NaN        0.902          0.920  
## 
## The model targets a toxicity level of 0.3.
## The model advocates continuing at dose 7.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we see that dose 7 is selected for the next cohort using the metric of selecting the dose with posterior expected probability of toxicity closest to the target.
In the above output, &lt;code&gt;mean_prob_tox&lt;/code&gt; broadly matches the values plotted in the lower right panel of Figure 1 in &lt;span class=&#34;citation&#34;&gt;Neuenschwander, Branson, and Gsponer (2008)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;further-work&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Further work&lt;/h3&gt;
&lt;p&gt;There are a few minor shortcomings of the NBG implementation in &lt;code&gt;escalation&lt;/code&gt; &amp;amp; &lt;code&gt;trialr&lt;/code&gt;.
Firstly, NBG propose a bivariate normal prior distribution on &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;.
However, the implementation in &lt;code&gt;trialr&lt;/code&gt; currently uses independent normal priors.
Hopefully, this will be addressed in a future release of &lt;code&gt;trialr&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Furthermore, NBG propose a method for selecting dose that accounts for the probability of recommending an overdose.
That logic is currently not implemented in &lt;code&gt;escalation&lt;/code&gt;, but will be in the near future.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;mcmc-crm&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;MCMC CRM&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;escalation&lt;/code&gt; already provides one-parameter CRM models via the &lt;code&gt;dfcrm&lt;/code&gt; package &lt;span class=&#34;citation&#34;&gt;(Cheung 2013)&lt;/span&gt;.
It now also provides MCMC implementations of those same one-parameter models:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skeleton &amp;lt;- c(0.05, 0.12, 0.25, 0.40, 0.55)
target &amp;lt;- 0.25

model1 &amp;lt;- get_trialr_crm(skeleton = skeleton, target = target, 
                         model = &amp;#39;empiric&amp;#39;, beta_sd = 1)
model2 &amp;lt;- get_trialr_crm(skeleton = skeleton, target = target, 
                         model = &amp;#39;logistic&amp;#39;, a0 = 3, 
                         beta_mean = 0, beta_sd = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and also adds a two-parameter logistic model:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model3 &amp;lt;- get_trialr_crm(skeleton = skeleton, target = target, 
                         model = &amp;#39;logistic2&amp;#39;, 
                         alpha_mean = 0, alpha_sd = 2, 
                         beta_mean = 0, beta_sd = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For more on the parameterisation of these methods, check out the CRM vignette in the &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34;&gt;&lt;code&gt;escalation&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;simulations-and-dose-paths&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Simulations and dose-paths&lt;/h2&gt;
&lt;p&gt;As with all methods in &lt;code&gt;escalation&lt;/code&gt;, simulations are supported right out of the box.&lt;/p&gt;
&lt;p&gt;For illustration, &lt;span class=&#34;citation&#34;&gt;Ji, Li, and Bekele (2007)&lt;/span&gt; present a simulation study to compare the performance of their TPI design to some alternatives.
They specify a design that uses a maximum sample size of thirty patients:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- get_tpi(num_doses = 8, target = 0.25, k1 = 1, k2 = 1.5,
                 exclusion_certainty = 0.95) %&amp;gt;%
  stop_at_n(n = 30)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and their scenario 1 assumes true probability of toxicity:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sc1 &amp;lt;- c(0.05, 0.25, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can then reproduce their simulated characteristics by running:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;set.seed(123)
sims &amp;lt;- model %&amp;gt;%
  simulate_trials(num_sims = 50, true_prob_tox = sc1, next_dose = 1)

sims&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Number of iterations: 50 
## 
## Number of doses: 8 
## 
## True probability of toxicity:
##    1    2    3    4    5    6    7    8 
## 0.05 0.25 0.50 0.60 0.70 0.80 0.90 0.95 
## 
## Probability of recommendation:
## NoDose      1      2      3      4      5      6      7      8 
##   0.00   0.14   0.76   0.10   0.00   0.00   0.00   0.00   0.00 
## 
## Probability of administration:
##     1     2     3     4     5     6     7     8 
## 0.226 0.606 0.160 0.008 0.000 0.000 0.000 0.000 
## 
## Sample size:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      30      30      30      30      30      30 
## 
## Total toxicities:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    4.00    6.00    7.00    7.44    9.00   11.00 
## 
## Trial duration:
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   15.30   27.50   30.75   30.65   34.90   42.30&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For the sake of speed, we ran just fifty iterations but in a real situation, many thousands of iterations would be more appropriate.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Amongst pure phase I designs, &lt;code&gt;escalation&lt;/code&gt; now supports:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CRM&lt;/li&gt;
&lt;li&gt;TPI&lt;/li&gt;
&lt;li&gt;mTPI&lt;/li&gt;
&lt;li&gt;BOIN&lt;/li&gt;
&lt;li&gt;NBG&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It also supports some designs that select dose by co-primary efficacy and toxicity outcomes, the so-called seamless phase I/II designs.
Those will be the subect of the next post on this blog.
Til then, good day.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-escalation&#34;&gt;
&lt;p&gt;Brock, Kristian. 2020. &lt;em&gt;Escalation: Modular Approach to Dose Finding Clinical Trials&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34;&gt;https://CRAN.R-project.org/package=escalation&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-dfcrm&#34;&gt;
&lt;p&gt;Cheung, Ken. 2013. &lt;em&gt;Dfcrm: Dose-Finding by the Continual Reassessment Method&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=dfcrm&#34;&gt;https://CRAN.R-project.org/package=dfcrm&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Ji2007&#34;&gt;
&lt;p&gt;Ji, Yuan, Yisheng Li, and B. Nebiyou Bekele. 2007. “Dose-finding in phase I clinical trials based on toxicity probability intervals.” &lt;em&gt;Clinical Trials&lt;/em&gt; 4 (3): 235–44. &lt;a href=&#34;https://doi.org/10.1177/1740774507079442&#34;&gt;https://doi.org/10.1177/1740774507079442&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Ji2010&#34;&gt;
&lt;p&gt;Ji, Yuan, Ping Liu, Yisheng Li, and B. Nebiyou Bekele. 2010. “A modified toxicity probability interval method for dose-finding trials.” &lt;em&gt;Clinical Trials&lt;/em&gt; 7 (6): 653–63. &lt;a href=&#34;https://doi.org/10.1177/1740774510382799&#34;&gt;https://doi.org/10.1177/1740774510382799&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Neuenschwander2008&#34;&gt;
&lt;p&gt;Neuenschwander, Beat, Michael Branson, and Thomas Gsponer. 2008. “Critical aspects of the Bayesian approach to phase I cancer trials.” &lt;em&gt;Statistics in Medicine&lt;/em&gt; 27: 2420–39. &lt;a href=&#34;https://doi.org/10.1002/sim.3230&#34;&gt;https://doi.org/10.1002/sim.3230&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>trialr and escalation</title>
      <link>https://www.kristianbrock.com/post/trialr-and-escalation/</link>
      <pubDate>Mon, 19 Oct 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/trialr-and-escalation/</guid>
      <description>


&lt;div id=&#34;summary&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;This post sets out how two of my R packages, &lt;a href=&#34;https://CRAN.R-project.org/package=trialr&#34;&gt;&lt;code&gt;trialr&lt;/code&gt;&lt;/a&gt; and &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34;&gt;&lt;code&gt;escalation&lt;/code&gt;&lt;/a&gt;, will work together and grow in the future.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;background&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Background&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://CRAN.R-project.org/package=trialr&#34;&gt;&lt;code&gt;trialr&lt;/code&gt;&lt;/a&gt; &lt;span class=&#34;citation&#34;&gt;(Brock 2020b; Brock 2019)&lt;/span&gt; is a package I wrote to fit complex Bayesian clinical trial models using &lt;a href=&#34;https://mc-stan.org/&#34;&gt;Stan&lt;/a&gt;.
Because I generally work on early phase trials, and because early phase trials are generally predisposed to Bayesian methods, the package ended up containing quite a few dose-finding methods like CRM &lt;span class=&#34;citation&#34;&gt;(O’Quigley, Pepe, and Fisher 1990)&lt;/span&gt; and EffTox &lt;span class=&#34;citation&#34;&gt;(Thall and Cook 2004)&lt;/span&gt;.
I initially added code to this package that would aid practical implementation of these methods, like conducting simulation studies and calculating future dose-paths.&lt;/p&gt;
&lt;p&gt;Later I introduced the &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34;&gt;&lt;code&gt;escalation&lt;/code&gt;&lt;/a&gt; &lt;span class=&#34;citation&#34;&gt;(Brock 2020a)&lt;/span&gt; package, containing a more general range of dose-finding methods (i.e. not just those that require MCMC methods for model-fitting).
The beauty of &lt;code&gt;escalation&lt;/code&gt; is that formalises the interface for dose-finding designs.
For instance, all methods recommend a dose through the &lt;code&gt;recommended_dose()&lt;/code&gt; function and distinguish between the need to stop or continue via the &lt;code&gt;continue()&lt;/code&gt; function.
This standard interface allows the elements of designs to become modules that can be arbitrarily combined.&lt;/p&gt;
&lt;p&gt;For example, &lt;code&gt;escalation&lt;/code&gt; allows you to start with a CRM model, add behaviour to stop when a certain sample size is reached, but ensure that the recommended dose is evaluated in at least &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; patients before stopping is permitted, all the while monitoring for excess toxicity at the lowest dose.
Because all of the modules obey the same interface, they can be combined in arbitrary ways to tailor the behaviour of designs.
The module that stops a trial when a target sample size is reached works whether it is preceded by a CRM design or BOIN design, for instance.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;do-we-need-both&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Do we need both?&lt;/h2&gt;
&lt;p&gt;By the time &lt;code&gt;escalation&lt;/code&gt; was released, there was quite a bit of overlap between &lt;code&gt;trialr&lt;/code&gt; and &lt;code&gt;escalation&lt;/code&gt;.
So do we need both?
Yes, and I will explain why!
Is &lt;code&gt;trialr&lt;/code&gt; now redundant?
Not at all, but it will become more focused.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;escalation&lt;/code&gt; went far further than &lt;code&gt;trialr&lt;/code&gt; in making dose-finding designs hot-swappable and customisable.
It makes sense that inferential tools like running simulations are offered in &lt;code&gt;escalation&lt;/code&gt; so that comparing designs is easy.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;trialr&lt;/code&gt; still has its place, however.
It takes care of fitting models to data using MCMC via Stan.
This is a reliable way of fitting complex (e.g. non-linear, multi-parameter) models when other methods struggle.
Henceforth, &lt;code&gt;trialr&lt;/code&gt; will focus only on Stan-based MCMC model-fitting.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;escalation&lt;/code&gt; will now use &lt;code&gt;trialr&lt;/code&gt; alongside dose-finding packages from other authors like &lt;code&gt;dfcrm&lt;/code&gt; &lt;span class=&#34;citation&#34;&gt;(Cheung 2013)&lt;/span&gt; and &lt;code&gt;BOIN&lt;/code&gt; &lt;span class=&#34;citation&#34;&gt;(Yuan and Liu 2018)&lt;/span&gt; to support the broadest possible array of dose-escalation methods.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;how-might-this-look-in-future&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;How might this look in future?&lt;/h2&gt;
&lt;p&gt;One of my near term goals is to add dose-response models to &lt;code&gt;trialr&lt;/code&gt; like Emax.
Dose-response modelling is a topic close to dose-finding trials but quite distinct from it.
When I add the Emax model, the Stan implementation will go in &lt;code&gt;trialr&lt;/code&gt;.
If the Emax model stands to be useful as a dose-selection tool, then it can be added to support the usual methods in the &lt;code&gt;escalation&lt;/code&gt; package.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;the-situation-now&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The situation now&lt;/h2&gt;
&lt;p&gt;I recently updated both packages on CRAN:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;trialr&lt;/code&gt; is now at v0.1.5 at &lt;a href=&#34;https://CRAN.R-project.org/package=trialr&#34; class=&#34;uri&#34;&gt;https://CRAN.R-project.org/package=trialr&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;escalation&lt;/code&gt; is now at v0.1.4 at &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34; class=&#34;uri&#34;&gt;https://CRAN.R-project.org/package=escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code&gt;escalation&lt;/code&gt; now depends on &lt;code&gt;trialr&lt;/code&gt; to deliver Stan-MCMC implementations of CRM, EffTox, and the phase I method of &lt;span class=&#34;citation&#34;&gt;Neuenschwander, Branson, and Gsponer (2008)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-Brock2019&#34;&gt;
&lt;p&gt;Brock, Kristian. 2019. “trialr: Bayesian Clinical Trial Designs in R and Stan.” &lt;em&gt;arXiv E-Prints&lt;/em&gt;, June, arXiv:1907.00161.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-escalation&#34;&gt;
&lt;p&gt;Brock, Kristian. 2020a. &lt;em&gt;Escalation: Modular Approach to Dose Finding Clinical Trials&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=escalation&#34;&gt;https://CRAN.R-project.org/package=escalation&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-trialr&#34;&gt;
&lt;p&gt;———. 2020b. &lt;em&gt;Trialr: Clinical Trial Designs in ’Rstan’&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=trialr&#34;&gt;https://CRAN.R-project.org/package=trialr&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-dfcrm&#34;&gt;
&lt;p&gt;Cheung, Ken. 2013. &lt;em&gt;Dfcrm: Dose-Finding by the Continual Reassessment Method&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=dfcrm&#34;&gt;https://CRAN.R-project.org/package=dfcrm&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Neuenschwander2008&#34;&gt;
&lt;p&gt;Neuenschwander, Beat, Michael Branson, and Thomas Gsponer. 2008. “Critical aspects of the Bayesian approach to phase I cancer trials.” &lt;em&gt;Statistics in Medicine&lt;/em&gt; 27: 2420–39. &lt;a href=&#34;https://doi.org/10.1002/sim.3230&#34;&gt;https://doi.org/10.1002/sim.3230&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-OQuigley1990&#34;&gt;
&lt;p&gt;O’Quigley, J, M Pepe, and L Fisher. 1990. “Continual Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.” &lt;em&gt;Biometrics&lt;/em&gt; 46 (1): 33–48. &lt;a href=&#34;https://doi.org/10.2307/2531628&#34;&gt;https://doi.org/10.2307/2531628&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Thall2004&#34;&gt;
&lt;p&gt;Thall, PF, and JD Cook. 2004. “Dose-Finding Based on Efficacy-Toxicity Trade-Offs.” &lt;em&gt;Biometrics&lt;/em&gt; 60 (3): 684–93.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-BOIN&#34;&gt;
&lt;p&gt;Yuan, Ying, and Suyu Liu. 2018. &lt;em&gt;BOIN: Bayesian Optimal Interval (Boin) Design for Single-Agent and Drug- Combination Phase I Clinical Trials&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=BOIN&#34;&gt;https://CRAN.R-project.org/package=BOIN&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Fetching BibTeX citations using rcrossref</title>
      <link>https://www.kristianbrock.com/post/using-rcrossref/</link>
      <pubDate>Sun, 26 Jul 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/using-rcrossref/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;I was drafting a review recently where I wanted to cite 122 papers (the subjects of the review) in one reference.
Ordinarily, I use the citation managers &lt;a href=&#34;https://www.zotero.org/&#34;&gt;Zotero&lt;/a&gt; and &lt;a href=&#34;https://www.mendeley.com/&#34;&gt;Mendeley&lt;/a&gt;.
I could have imported all 122 PDFs into Zotero and then output the citations in a BibTeX file.
However, that felt like too much manual work so I searched for a more automated way.&lt;/p&gt;
&lt;p&gt;I had a list of 122 DOIs and I wanted the BibTeX entry for each.
My suspicion was that there would be an R package to automate this task.
That is how I stumbled across the &lt;code&gt;rcrossref&lt;/code&gt; package by &lt;span class=&#34;citation&#34;&gt;Chamberlain et al. (2020)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;demonstration-of-rcrossref&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Demonstration of &lt;code&gt;rcrossref&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;rcrossref&lt;/code&gt; is on CRAN so you can install it in the usual way:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;install.packages(&amp;#39;rcrossref&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let me immodestly demonstrate the package by fetching a BibTeX entry for one of my own papers (my first, in fact).
You simply call the &lt;code&gt;cr_cn&lt;/code&gt; function with the DOI you seek:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rcrossref)

doi &amp;lt;- &amp;#39;10.1186/s12874-017-0381-x&amp;#39;
refs &amp;lt;- cr_cn(dois = doi, format = &amp;quot;bibtex&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The citation can be returned in one of many formats.
As stated, I want BibTeX.&lt;/p&gt;
&lt;p&gt;Let’s see the result:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;writeLines(refs)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## @article{Brock_2017,
##  doi = {10.1186/s12874-017-0381-x},
##  url = {https://doi.org/10.1186%2Fs12874-017-0381-x},
##  year = 2017,
##  month = {jul},
##  publisher = {Springer Science and Business Media {LLC}},
##  volume = {17},
##  number = {1},
##  author = {Kristian Brock and Lucinda Billingham and Mhairi Copland and Shamyla Siddique and Mirjana Sirovica and Christina Yap},
##  title = {Implementing the {EffTox} dose-finding design in the Matchpoint trial},
##  journal = {{BMC} Medical Research Methodology}
## }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Perfect.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;the-bulk-solution&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The bulk solution&lt;/h2&gt;
&lt;p&gt;Having fetched one example successfully, I imagined a viable solution would be to write a &lt;code&gt;for&lt;/code&gt;-loop.
However, the solution I used was even simpler than that.
You can send in a vector of DOIs via the &lt;code&gt;dois&lt;/code&gt; parameter.
Let me add another of my pivotal world-changing research papers to illustrate the point:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;doi &amp;lt;- c(
  &amp;#39;10.1186/s12874-017-0381-x&amp;#39;,
  &amp;#39;10.1016/S2213-2600(20)30033-3&amp;#39;
)

refs &amp;lt;- cr_cn(dois = doi, format = &amp;quot;bibtex&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;refs&lt;/code&gt; object is now a &lt;code&gt;list&lt;/code&gt; of two BibTeX entries.
Writing those references to a text stream is slightly more awkward than before:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;writeLines(unlist(lapply(refs, paste, collapse=&amp;quot; &amp;quot;)))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## @article{Brock_2017,
##  doi = {10.1186/s12874-017-0381-x},
##  url = {https://doi.org/10.1186%2Fs12874-017-0381-x},
##  year = 2017,
##  month = {jul},
##  publisher = {Springer Science and Business Media {LLC}},
##  volume = {17},
##  number = {1},
##  author = {Kristian Brock and Lucinda Billingham and Mhairi Copland and Shamyla Siddique and Mirjana Sirovica and Christina Yap},
##  title = {Implementing the {EffTox} dose-finding design in the Matchpoint trial},
##  journal = {{BMC} Medical Research Methodology}
## }
## @article{Middleton_2020,
##  doi = {10.1016/s2213-2600(20)30033-3},
##  url = {https://doi.org/10.1016%2Fs2213-2600%2820%2930033-3},
##  year = 2020,
##  month = {mar},
##  publisher = {Elsevier {BV}},
##  author = {Gary Middleton and Kristian Brock and Joshua Savage and Rhys Mant and Yvonne Summers and John Connibear and Riyaz Shah and Christian Ottensmeier and Paul Shaw and Siow-Ming Lee and Sanjay Popat and Colin Barrie and Gloria Barone and Lucinda Billingham},
##  title = {Pembrolizumab in patients with non-small-cell lung cancer of performance status 2 ({PePS}2): a single arm, phase 2 trial},
##  journal = {The Lancet Respiratory Medicine}
## }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Having mastered that, however, writing the BibTeX entries to a file was a piece of cake:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myfile = file(&amp;#39;~/bibliography.bib&amp;#39;)
writeLines(unlist(lapply(refs, paste, collapse=&amp;quot; &amp;quot;)), con = myfile)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Job done?
Not quite.&lt;/p&gt;
&lt;p&gt;There was, in fact, one more challenge to overcome.
To cite the papers in &lt;span class=&#34;math inline&#34;&gt;\(\LaTeX\)&lt;/span&gt;, I would need the 122 citation keys, i.e. the identifying labels that come after the &lt;code&gt;@article{&lt;/code&gt;.
We can see that CrossRef, the service that converts the DOI into a BibTeX citation, labels papers using the pattern &lt;code&gt;author_yyyy&lt;/code&gt;.
I extracted the citation keys using a bit of &lt;a href=&#34;https://en.wikipedia.org/wiki/Regular_expression&#34;&gt;RegEx&lt;/a&gt; and the &lt;code&gt;stringr&lt;/code&gt; and &lt;code&gt;purrr&lt;/code&gt; packages:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(purrr)
library(stringr)

cite_keys &amp;lt;- refs %&amp;gt;% 
  map_chr(~ str_extract(.x, pattern = &amp;#39;\\@article\\{[A-Za-z_]*[0-9]+&amp;#39;)) %&amp;gt;% 
  map_chr(~ str_extract(.x, pattern = &amp;#39;[A-Za-z_]*[0-9]+&amp;#39;))

cite_keys&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Brock_2017&amp;quot;     &amp;quot;Middleton_2020&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I am not great at RegEx so I imagine there is a better way of doing that, but my method worked.
Importantly, the above will work with double-barreled names like &lt;code&gt;name1_name2_yyyy&lt;/code&gt;.
Finally, I pasted the contents of &lt;code&gt;cite_keys&lt;/code&gt; into my tex file.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;end-product&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;End product&lt;/h2&gt;
&lt;p&gt;This is the end result:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;result.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;One hundred and twenty-two consecutive references compacted into one reference, as required.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-rcrossref&#34;&gt;
&lt;p&gt;Chamberlain, Scott, Hao Zhu, Najko Jahn, Carl Boettiger, and Karthik Ram. 2020. &lt;em&gt;Rcrossref: Client for Various ’Crossref’ ’Apis’&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=rcrossref&#34;&gt;https://CRAN.R-project.org/package=rcrossref&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Fitting the Emax Model in R</title>
      <link>https://www.kristianbrock.com/post/emax-intro/</link>
      <pubDate>Wed, 13 May 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/emax-intro/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Let’s say we have some outcomes observed at different doses or exposures of some intervention.
Those data might look like this:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
library(dplyr)

df &amp;lt;- tibble(
  Exposure = c(10, 25, 50, 75, 100, 150, 300, 400),
  Response = c(0.03, 0.04, 0.15, 0.12, 0.25, 0.43, 0.54, 0.47)
)

df %&amp;gt;% 
  ggplot(aes(x = Exposure, y = Response)) + 
  geom_point()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Exposure-response relationships are incredibly common in medical research.
They do not just arise in phase I trials.&lt;/p&gt;
&lt;p&gt;The response variable could be interpreted as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the average level of target inhibition;&lt;/li&gt;
&lt;li&gt;the average concentration in serum;&lt;/li&gt;
&lt;li&gt;the percentage of subjects in a sample experiencing an event.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Likewise, the exposure variable could be interpreted as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the prevalence of some characteristic in a population;&lt;/li&gt;
&lt;li&gt;time spent in a certain state;&lt;/li&gt;
&lt;li&gt;the quantity of molecule popped into a patient’s mouth.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So how would we analyse data like this?
An ordinary linear model looks a bit of a stretch because the response variable appears to stop increasing at high exposures.
A generalised linear model (GLM) might be a fruitful approach.&lt;/p&gt;
&lt;p&gt;Here is a logit model fit to the data:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(broom)

df %&amp;gt;% 
  glm(data = ., formula = Response ~ Exposure, family = binomial(&amp;#39;logit&amp;#39;)) %&amp;gt;% 
  augment() %&amp;gt;% 
  mutate(Response = gtools::inv.logit(.fitted)) %&amp;gt;% 
  ggplot(aes(x = Exposure, y = Response)) + 
  geom_line() + 
  geom_point(data = df)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;and here is a probit model:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df %&amp;gt;% 
  glm(data = ., formula = Response ~ Exposure, family = binomial(&amp;#39;probit&amp;#39;)) %&amp;gt;% 
  augment() %&amp;gt;% 
  mutate(Response = gtools::inv.logit(.fitted)) %&amp;gt;% 
  ggplot(aes(x = Exposure, y = Response)) + 
  geom_line() + 
  geom_point(data = df)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;These fits are awful.
Both of these GLM approaches suffer from the same simple problem; they assume that the event probability tends to 1 as the linear predictor tends to infinity.
Put another way, there is no way for the response curve to asymptote to some value other than 1.0.
This bakes into the analysis that an event probability of 1.0 is not only possible, but guaranteed, given high enough exposure.
In many situations, this assumption is inappropriate.&lt;/p&gt;
&lt;p&gt;So what might we do instead?&lt;/p&gt;
&lt;div id=&#34;the-emax-model&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The Emax Model&lt;/h2&gt;
&lt;p&gt;Emax is a non-linear model for estimating dose-response curves.&lt;/p&gt;
&lt;p&gt;The general model form is:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ R_i = E_o + \frac{D_i^N \times E_{max}}{D_i^N + {ED}_{50}^N}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(R_i\)&lt;/span&gt; is the response for experimental unit &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(D_i\)&lt;/span&gt; is the exposure (or dose) of experimental unit &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(E_0\)&lt;/span&gt; is the expected response when exposure is zero, or the zero-dose effect, or the &lt;em&gt;basal effect&lt;/em&gt;;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(E_{max}\)&lt;/span&gt; is the maximum effect attributable to exposure;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(ED_{50}\)&lt;/span&gt; is the exposure that produces half of &lt;span class=&#34;math inline&#34;&gt;\(E_{max}\)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(N &amp;gt; 0\)&lt;/span&gt; is the slope factor, determining the steepness of the dose-response curve.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34;&gt;Macdougall (2006)&lt;/span&gt; gives a fantastic introduction to the method, providing excellent interpretation of the parameters and summaries of the main model extensions.
We have borrowed here their notation and elementary explanation of model terms.&lt;/p&gt;
&lt;p&gt;The model variant above is called the &lt;em&gt;sigmoidal&lt;/em&gt; Emax model.
The variant with &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; fixed to take the value 1 is called the &lt;em&gt;hyperbolic&lt;/em&gt; model.&lt;/p&gt;
&lt;p&gt;Fitting this model to some data means estimating values for the free parameters, &lt;span class=&#34;math inline&#34;&gt;\(E_0, E_{max}, ED_{50}\)&lt;/span&gt;, and possibly &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;, conditional on the observed &lt;span class=&#34;math inline&#34;&gt;\(R_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(D_i\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Fortunately, there are packages in R that will fit this model.
We introduce maximum likelihood and Bayesian approaches below.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;maximum-likelihood-methods&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Maximum likelihood methods&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34;&gt;Bornkamp (2019)&lt;/span&gt; provides a function in the &lt;code&gt;DoseFinding&lt;/code&gt; package for fitting both the hyperbolic and sigmoidal model variants.&lt;/p&gt;
&lt;p&gt;We demonstrate first the hyperbolic approach, fitting it to our manufactured dataset:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(DoseFinding)

emax0 &amp;lt;- fitMod(Exposure, Response, data = df,  model = &amp;quot;emax&amp;quot;)
plot(emax0)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;By default, the package uses &lt;code&gt;lattice&lt;/code&gt;-type graphics.
We see that the model fit is much better than the GLM approaches above.
To see the estimated parameters, we run:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(emax0)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Dose Response Model
## 
## Model: emax 
## Fit-type: normal 
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.08579 -0.03974  0.00223  0.02980  0.08854 
## 
## Coefficients with approx. stand. error:
##      Estimate Std. Error
## e0     -0.052      0.079
## eMax    0.827      0.172
## ed50  162.962    117.031
## 
## Residual standard error: 0.0698 
## Degrees of freedom: 5&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We now fit the sigmoidal model.
This simply involves calling the same function with a different &lt;code&gt;model&lt;/code&gt; parameter:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;emax1 &amp;lt;- fitMod(Exposure, Response, data = df,  model = &amp;quot;sigEmax&amp;quot;)
plot(emax1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;It is clear that the extra parameter dramatically improves the model fit.
Glimpsing the parameter values:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(emax1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Dose Response Model
## 
## Model: sigEmax 
## Fit-type: normal 
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.0721 -0.0154  0.0120  0.0251  0.0389 
## 
## Coefficients with approx. stand. error:
##      Estimate Std. Error
## e0     0.0594     0.0324
## eMax   0.4515     0.0535
## ed50 107.0215    11.5670
## h      4.1370     1.6398
## 
## Residual standard error: 0.0497 
## Degrees of freedom: 4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we learn that the &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; parameter (which they call &lt;code&gt;h&lt;/code&gt; to keep us on our toes) is not particularly consistent with the value 1.
The extra degree of freedom has roughly halved the estimated value of &lt;span class=&#34;math inline&#34;&gt;\(E_{max}\)&lt;/span&gt; and more than halved the associated standard error.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;bayesian-methods&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Bayesian methods&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;rstanemax&lt;/code&gt; package by &lt;span class=&#34;citation&#34;&gt;Yoshida (2019)&lt;/span&gt; implements a Bayesian version of Emax, offloading MCMC sampling to the miracle software Stan &lt;span class=&#34;citation&#34;&gt;(Carpenter et al. 2016)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Fitting the sigmoidal model is as simple as running code like:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rstanemax)

stan1 &amp;lt;- stan_emax(Response ~ Exposure, data = df, gamma.fix = NULL, 
                   seed = 12345, cores = 4, control = list(adapt_delta = 0.95))
stan1&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Inference for Stan model: emax.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##         mean se_mean    sd  2.5%    25%    50%    75%  97.5% n_eff Rhat
## emax    0.51    0.00  0.12  0.35   0.44   0.48   0.55   0.86   681    1
## e0      0.04    0.00  0.04 -0.05   0.02   0.05   0.07   0.12  1409    1
## ec50  122.33    1.76 45.01 81.81 100.91 110.81 124.89 257.70   651    1
## gamma   3.66    0.06  2.03  0.96   2.18   3.32   4.74   8.67  1220    1
## sigma   0.07    0.00  0.03  0.03   0.05   0.06   0.08   0.14   923    1
## 
## Samples were drawn using NUTS(diag_e) at Wed May 13 19:15:55 2020.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; parameter in this package is referred to as &lt;code&gt;gamma&lt;/code&gt; (still with me?) and the &lt;code&gt;gamma.fix = NULL&lt;/code&gt; argument causes the variable to be estimated from the data.
The argument name suggests you can provide your own fixed value - I have not investigated.
To fit the hyperbolic version, you just omit the &lt;code&gt;gamma.fix&lt;/code&gt; argument.&lt;/p&gt;
&lt;p&gt;We see that there is a little bit of difference in each of the estimated variables but nothing to get alarmed about.&lt;/p&gt;
&lt;p&gt;The package also provides a nice way of fetching predicted values:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;samp &amp;lt;- rstanemax::posterior_predict(
  stan1, returnType = &amp;quot;tibble&amp;quot;, 
  newdata = tibble(exposure = seq(0, 400, length.out = 100)))

samp %&amp;gt;% head(10) %&amp;gt;% knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;right&#34;&gt;mcmcid&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;exposure&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;emax&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;e0&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;ec50&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;gamma&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sigma&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;respHat&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;response&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07183650&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2860366&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.040404&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07187133&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3240279&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.080808&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07206919&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2041787&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.121212&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07254184&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0818142&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.161616&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07338111&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0172850&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.202020&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07466294&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1978203&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.242424&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07644671&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2342920&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.282828&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.07877353&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0095302&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32.323232&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.08166463&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0747148&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;right&#34;&gt;100&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36.363636&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1712489&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0718365&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;89.70576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.741876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1903292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.08512041&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0137214&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This facilitates my favourite method of visualising Bayesian model inferences: overplotting dots and lines.&lt;/p&gt;
&lt;p&gt;E.g. how does the expected curve look?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;samp %&amp;gt;% head(100 * 150) %&amp;gt;% 
  rename(Exposure = exposure, Response = respHat) %&amp;gt;% 
  ggplot(aes(x = Exposure, y = Response)) + 
  geom_point(data = df) +
  geom_line(aes(group = mcmcid), alpha = 0.1, col = &amp;#39;purple&amp;#39;) + 
  ylim(0, NA)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Each of the 150 purple lines above is a candidate for the mean exposure-response curve (or dose-response curve, if you prefer), hence the column name &lt;code&gt;respHat&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The subject-level predictions (i.e. the predictions with added noise) are also available in the &lt;code&gt;samp&lt;/code&gt; object via the &lt;code&gt;response&lt;/code&gt; column.
For instance, if you wanted to infer on the distribution of responses for a single unit (patient, dog, country, whatever) with given exposure, this is the distribution you would be using:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;samp %&amp;gt;% head(100 * 100) %&amp;gt;% 
  rename(Exposure = exposure, Response = response) %&amp;gt;% 
  ggplot(aes(x = Exposure, y = Response)) + 
  geom_point(alpha = 0.1) +
  ylim(0, NA)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/emax-intro/index_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;In the plot above, responses are predicted at each of one hundred evenly-spaced exposures.
At each exposure, there are 100 points shown - i.e. each vertical tower contains exactly 100 points.
Thus, each dot represents a percentile.&lt;/p&gt;
&lt;p&gt;That is a bloody nice plot, isn’t it?
Time to sign off.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;next-steps&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Next steps&lt;/h1&gt;
&lt;p&gt;In a forthcoming post I will fit the Emax model to outcomes in the dataset of phase I outcomes of &lt;span class=&#34;citation&#34;&gt;Brock et al. (2019)&lt;/span&gt; introduced in &lt;a href=&#34;post/dose-finding-data/&#34;&gt;this post&lt;/a&gt;.
Til then.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level1 unnumbered&#34;&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-DoseFinding&#34;&gt;
&lt;p&gt;Bornkamp, Bjoern. 2019. &lt;em&gt;DoseFinding: Planning and Analyzing Dose Finding Experiments&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=DoseFinding&#34;&gt;https://CRAN.R-project.org/package=DoseFinding&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-BrockDoseFindingData&#34;&gt;
&lt;p&gt;Brock, Kristian, Victoria Homer, Gurjinder Soul, Claire Potter, Cody Chiuzan, and Shing Lee. 2019. “Dose-Level Toxicity and Efficacy Outcomes from Dose-Finding Clinical Trials in Oncology.” &lt;a href=&#34;https://doi.org/10.25500/edata.bham.00000337&#34;&gt;https://doi.org/10.25500/edata.bham.00000337&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Carpenter2016&#34;&gt;
&lt;p&gt;Carpenter, Bob, Andrew Gelman, Matt Hoffman, Daniel Lee, Ben Goodrich, Michael Betancourt, Marcus A. Brubaker, Peter Li, and Allen Riddell. 2016. “Stan: A Probabilistic Programming Language.” &lt;em&gt;Journal of Statistical Software&lt;/em&gt; 76 (Ii): 1–32.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-macdougallAnalysisDoseResponse2006a&#34;&gt;
&lt;p&gt;Macdougall, James. 2006. “Analysis of Dose–Response Studies—Emax Model.” In &lt;em&gt;Dose Finding in Drug Development&lt;/em&gt;, edited by Naitee Ting, 127–45. New York, NY: Springer New York. &lt;a href=&#34;https://doi.org/10.1007/0-387-33706-7_9&#34;&gt;https://doi.org/10.1007/0-387-33706-7_9&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-rstanemax&#34;&gt;
&lt;p&gt;Yoshida, Kenta. 2019. &lt;em&gt;Rstanemax: Emax Model Analysis with ’Stan’&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=rstanemax&#34;&gt;https://CRAN.R-project.org/package=rstanemax&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Sample sizes in phase I</title>
      <link>https://www.kristianbrock.com/post/dose-finding-trial-sizes/</link>
      <pubDate>Thu, 07 May 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/dose-finding-trial-sizes/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;I recently had reason to estimate the average size of a dose-escalation trial.
Based on my own experience, my immediate answer was “about 30 patients”.
However, using the data of &lt;span class=&#34;citation&#34;&gt;Brock et al. (2019)&lt;/span&gt; introduced in &lt;a href=&#34;post/dose-finding-data/&#34;&gt;this recent post&lt;/a&gt;, there is no reason to guess.
The dataset contains dose-level outcomes from 122 phase I clinical trial manuscripts reporting results of 139 dose-escalation experiments in cancer between 2008 and 2014.&lt;/p&gt;
&lt;p&gt;Perhaps surprisingly, we did not record the sample size of each trial.
The focus of the research was not phase I trials per se, but the outcomes seen at individual doses in phase I trials.
For that reason, we recorded the number of patients evaluable at each dose &lt;em&gt;for several outcomes&lt;/em&gt;, including toxicity and efficacy outcomes.
As &lt;a href=&#34;post/dose-finding-data/&#34;&gt;this post explains&lt;/a&gt;, the outcome most commonly reported was incidence of dose-limiting toxicity (DLT), with about 95% of studies reporting dose-level DLT data.
Thus, we can derive the number of patients in a dose-escalation study by summing the numbers of patients at each dose.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;empirical-sample-size-of-phase-i-trials&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Empirical sample size of phase I trials&lt;/h1&gt;
&lt;p&gt;With those caveats out the way, let’s load the data:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;source(&amp;#39;https://raw.githubusercontent.com/brockk/dosefindingdata/master/Load.R&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and some required packages:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
library(ggplot2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and then calculate the number of patients in each study:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable &amp;lt;- binary_events %&amp;gt;% 
  filter(OutcomeId == 1) %&amp;gt;% # This is DLT
  group_by(Study) %&amp;gt;% 
  summarise(NumPatients = sum(n), NumDoses = n()) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can simply visualise those summarised data:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  ggplot(aes(x = NumPatients)) + 
  stat_count(aes(y = ..prop..), alpha = 0.5) + 
  geom_density(col = &amp;#39;blue&amp;#39;, size = 1.3) + 
  xlim(0, NA) + 
  labs(x = &amp;#39;Total sample size&amp;#39;, y = &amp;#39;Proportion&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/dose-finding-trial-sizes/index_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;to learn that the modal size is about &lt;span class=&#34;math inline&#34;&gt;\(n=20\)&lt;/span&gt;.
The distribution has a pronounced positive skew with a small number of relatively large sample sizes seen.&lt;/p&gt;
&lt;p&gt;Calculating summary statistics:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  pull(NumPatients) %&amp;gt;% 
  summary()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    6.00   18.00   23.00   27.38   33.00   93.00&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we see that the median size is 23 patients with an inter-quartile range of (18, 33).
My initial guess of about 30 was a bit toppy.&lt;/p&gt;
&lt;div id=&#34;by-drug-type&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;By drug type&lt;/h2&gt;
&lt;p&gt;The database also records various descriptive variables about the clinical scenarios.
We can, for example, investigate sample size by the type of drug that is having its dose varied.&lt;/p&gt;
&lt;p&gt;Let’s do that.
First, let us check which treatment types are contained:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  left_join(studies, by = &amp;#39;Study&amp;#39;) %&amp;gt;%
  count(DoseVaryingTreatmentType) %&amp;gt;% 
  arrange(-n) %&amp;gt;% 
  head(5) %&amp;gt;% knitr::kable(digits = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;DoseVaryingTreatmentType&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Chemotherapy&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Inhibitor&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Monoclonal Antibody&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Chemotherapy + inhibitor&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Immunomodulatory drug&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We see that this period yielded trials mostly of chemotherapy and inhibitor drugs.
It really only makes sense to summarise sample sizes for those two categories:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  left_join(studies, by = &amp;#39;Study&amp;#39;) %&amp;gt;%
  filter(DoseVaryingTreatmentType %in% c(&amp;#39;Chemotherapy&amp;#39;, &amp;#39;Inhibitor&amp;#39;)) %&amp;gt;% 
  ggplot(aes(x = NumPatients)) + 
  stat_count(aes(y = ..prop..), alpha = 0.5) + 
  geom_density(col = &amp;#39;blue&amp;#39;, size = 1.3) + 
  xlim(0, NA) + 
  facet_wrap(~ DoseVaryingTreatmentType, ncol = 1) + 
  labs(x = &amp;#39;Total sample size&amp;#39;, y = &amp;#39;Proportion&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/dose-finding-trial-sizes/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The distributions look fairly exchangeable, suggesting that phase I trials of inhibitors have tended to use similar sizes to those of chemotherapies.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;haematological-vs-non-haematological&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Haematological vs non-haematological&lt;/h2&gt;
&lt;p&gt;We can instead contrast the sample sizes of trials in haematological and solid tumour (or non-haematological) diseases:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  left_join(studies, by = &amp;#39;Study&amp;#39;) %&amp;gt;%
  filter(HaemNonhaem %in% c(&amp;#39;Haematological&amp;#39;, &amp;#39;NonHaematological&amp;#39;)) %&amp;gt;% 
  ggplot(aes(x = NumPatients)) + 
  stat_count(aes(y = ..prop..), alpha = 0.5) + 
  geom_density(col = &amp;#39;blue&amp;#39;, size = 1.3) + 
  xlim(0, NA) + 
  facet_wrap(~ HaemNonhaem, ncol = 1) + 
  labs(x = &amp;#39;Total sample size&amp;#39;, y = &amp;#39;Proportion&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/dose-finding-trial-sizes/index_files/figure-html/unnamed-chunk-8-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Again, we see that the distributions are largely coincident.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;sample-size-per-dose-investigated&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Sample-size per dose investigated&lt;/h2&gt;
&lt;p&gt;We can plot sample size against the number of dose investigated to learn roughly how many patients are evaluated at each dose:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  ggplot(aes(x = NumDoses, y = NumPatients)) + 
  geom_point() + 
  geom_smooth(method = &amp;#39;loess&amp;#39;) + 
  xlim(0, NA)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/dose-finding-trial-sizes/index_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;In one particular study, each patient received a different dose.
That is the outlier on the right of the plot above.
If we exclude that point, we get a better look at the relationship:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  filter(NumDoses &amp;lt; 20) %&amp;gt;% 
  ggplot(aes(x = NumDoses, y = NumPatients)) + 
  geom_point() + 
  geom_smooth(method = &amp;#39;loess&amp;#39;) + 
  xlim(0, NA)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## `geom_smooth()` using formula &amp;#39;y ~ x&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/dose-finding-trial-sizes/index_files/figure-html/unnamed-chunk-10-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For numbers of doses less than about 10, the aggregate sample size is broadly linear in the number of doses.
How many patients per dose?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dlt_evaluable %&amp;gt;% 
  filter(NumDoses &amp;lt; 20) %&amp;gt;% 
  lm(NumPatients ~ NumDoses, data = .) %&amp;gt;% 
  broom::tidy() %&amp;gt;% knitr::kable()&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.020828&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.6361675&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.421948&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0008352&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;NumDoses&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.831117&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5030493&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.615787&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;About 4, with (3, 5) being a good working uncertainty interval.
That is not to say that phase I trials should be that size, of course!
Merely a reflection of what was done, on average, between 2008 and 2014.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-BrockDoseFindingData&#34;&gt;
&lt;p&gt;Brock, Kristian, Victoria Homer, Gurjinder Soul, Claire Potter, Cody Chiuzan, and Shing Lee. 2019. “Dose-Level Toxicity and Efficacy Outcomes from Dose-Finding Clinical Trials in Oncology.” &lt;a href=&#34;https://doi.org/10.25500/edata.bham.00000337&#34;&gt;https://doi.org/10.25500/edata.bham.00000337&lt;/a&gt;. &lt;a href=&#34;https://doi.org/10.25500/edata.bham.00000337&#34;&gt;https://doi.org/10.25500/edata.bham.00000337&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Dataset containing outcomes from dose-finding trials in cancer</title>
      <link>https://www.kristianbrock.com/post/dose-finding-data/</link>
      <pubDate>Wed, 06 May 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/dose-finding-data/</guid>
      <description>


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Do we expect the incidence of dose-limiting toxicity to increase as dose increases in dose-escalation clinical trials?
Categorically, yes.
The toxicologists’ epithet &lt;em&gt;sola dosis facit venenum&lt;/em&gt; or &lt;em&gt;the dose makes the poison&lt;/em&gt; says that any substance can be dangerous if administered in great enough quantities.&lt;/p&gt;
&lt;p&gt;What about efficacy?
Do we expect efficacy to be greater at higher doses?
Implicitly we must do whenever we use a method that seeks the &lt;em&gt;maximum tolerable dose&lt;/em&gt; (MTD).
The two adjectives in that phrase are fundamental to understanding the most common approach in dose-escalation:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;we seek the &lt;em&gt;maximum&lt;/em&gt; dose, i.e. we expressly favour higher doses;&lt;/li&gt;
&lt;li&gt;so long as the dose is &lt;em&gt;tolerable&lt;/em&gt;, i.e. it is associated with an acceptable toxicity probability.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;MTD-seeking methods are pervasive in the dose-finding literature.
Rule-based methods like the 3+3 seek the MTD.
&lt;span class=&#34;citation&#34;&gt;Rogatko et al. (2007)&lt;/span&gt; and &lt;span class=&#34;citation&#34;&gt;Chiuzan et al. (2017)&lt;/span&gt; showed that the 3+3 method was predominant in dose-finding trials between 1991 and 2014.
Many model-based methods like the &lt;em&gt;continual reassessment method&lt;/em&gt; (CRM, &lt;span class=&#34;citation&#34;&gt;O’Quigley, Pepe, and Fisher (1990)&lt;/span&gt;) and &lt;em&gt;escalation with overdose control&lt;/em&gt; (EWOC, &lt;span class=&#34;citation&#34;&gt;Tighiouart and Rogatko (2010)&lt;/span&gt;) also seek the MTD.&lt;/p&gt;
&lt;p&gt;These methods decide dose by considering only toxicity outcomes.
The absence of efficacy from the decision reveals that there must be an assumption.
Specifically, MTD-seeking methods assume efficacy increases monotonically in dose.
Under this assuption, the MTD offers the best chance of efficacy for an acceptable risk of toxicity.&lt;/p&gt;
&lt;p&gt;But this is all just theory.
Science is a sceptical pursuit, and none are more sceptical than clinical trial statisticians.
The shift in cancer away from cytotoxic drugs (like chemotherapy) to cytostatic drugs (like targeted therapies) over the last two decades has provided more reason to be sceptical.&lt;/p&gt;
&lt;p&gt;So what evidence is there in recent clinical trials that the probability of toxicity increases in dose?
And more importantly, what evidence is there that the probability of efficacy increases in dose?&lt;/p&gt;
&lt;p&gt;Seeking to answer these questions motivated some researchers and I to gather data from many dose-finding clinical trials in cancer run between 2008 and 2014.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;methods&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Methods&lt;/h1&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34;&gt;Chiuzan et al. (2017)&lt;/span&gt; conducted a systematic review of the methods used in cancer dose-finding trials.
Their findings mirrored those of &lt;span class=&#34;citation&#34;&gt;Rogatko et al. (2007)&lt;/span&gt; from the previous decade that the overwhelming majority of dose-finding trials (over 90%) use a rule-based design.
The assumption that efficacy increases in dose is evidently pervasive, irrespective the shift in research to targeted therapies.
I worked with Victoria Homer, Gurjinder Soul and Claire Potter of the University of Birmingham to extract dose-level outcomes from a large number of dose-finding trial publications to investigate the suitability of this assumption.&lt;/p&gt;
&lt;p&gt;In their review, Chiuzan &lt;em&gt;et al.&lt;/em&gt; found 1,712 manuscripts published between 2008 and 2014.
With the best will in the world, we would never be able to extract data from this many manuscripts.
Chiuzan &lt;em&gt;et al.&lt;/em&gt; published in their paper a large table summarising the trials that used model-based methods, like CRM or EWOC, of which there were 92 examples.
This number was feasible for data extraction.
However, the subset of trials that use model-based methods may not be representative of the entire sample.
With the cooperation of Shing Lee and Cody Chiuzan of Columbia University, we supplemented the list of 92 model-based papers with 30 randomly-selected manuscripts that used rule-based methods, to create a list of 122 manuscripts.&lt;/p&gt;
&lt;div id=&#34;data-items&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Data items&lt;/h2&gt;
&lt;p&gt;Each of the 122 manuscripts presented the results of at least one dose-finding experiment in humans.
Some papers reported the results of more than one experiment.&lt;/p&gt;
&lt;p&gt;From each, we extracted:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;characteristic data, including:
&lt;ul&gt;
&lt;li&gt;type of cancer;&lt;/li&gt;
&lt;li&gt;name and type of experimental therapy;&lt;/li&gt;
&lt;li&gt;name and type of concommitant therapies;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;outcome data &lt;strong&gt;at each dose&lt;/strong&gt;, including:
&lt;ul&gt;
&lt;li&gt;dose level;&lt;/li&gt;
&lt;li&gt;number of patients evaluated;&lt;/li&gt;
&lt;li&gt;number of toxicity events recorded;&lt;/li&gt;
&lt;li&gt;number of efficacy events recorded.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;dose-level-outcomes-vs-pooled-outcomes&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Dose-level outcomes vs pooled outcomes&lt;/h3&gt;
&lt;p&gt;We expressly sought outcomes broken down by dose-level to investigate the suitability of the assumptions of monotonically increasing toxicity and efficacy.
We did not collect outcomes that were reported by pooling all dose-levels because this would not help answer our research questions.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;toxicity-outcomes&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Toxicity outcomes&lt;/h3&gt;
&lt;p&gt;Dose-limiting toxicity (DLT) is the de-facto standard safety outcome in dose-finding trials.
Manifestation of DLT involves the occurence of pre-specified adverse events (AEs) that are serious enough that they would motivate the clinician to not consider higher doses in the affected patient.
The precise definition of DLT varies from trial to trial but should always be detailed in the trial protocol.
The definition of DLT in a trial may reflect the clinical characteristics of the disease and the antipated adverse events from the entire treatment ensemble (i.e. arising from the experimental drug and concommitant drugs).
Data on DLT was sought in every manuscript.&lt;/p&gt;
&lt;p&gt;Where reported, we also collected other outcomes that reflected general drug safety, like &lt;em&gt;occurrence of grade 3-4 AE&lt;/em&gt; or &lt;em&gt;occurence of serious adverse event&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;efficacy-outcomes&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Efficacy outcomes&lt;/h3&gt;
&lt;p&gt;The scientific question motivating this research concerns drug efficacy and how this changes as dose is increased.
&lt;em&gt;Efficacy&lt;/em&gt; is only loosely defined in cancer.
There is no single outcome that is unambiguously accepted as the variable best reflecting efficacy.&lt;/p&gt;
&lt;p&gt;Applications for drug licencing are generally supported by phase III trials that use survival-type outcomes like overall survival (OS) and progression-free survival (PFS).
In contrast, early phase trials, when they evaluate efficacy, tend to use surrogate outcomes that can be evaluated over the short-term like disease response.&lt;/p&gt;
&lt;p&gt;Assessing disease response generally involves comparing the extent of disease (e.g. tumour size or number of leukaemic cells) at baseline and after treatment administration to characterise the patient’s response to treatment using one of several categories.&lt;/p&gt;
&lt;p&gt;The most common response outcome categorisation used in cancer trials is RECIST response &lt;span class=&#34;citation&#34;&gt;(Eisenhauer et al. 2009)&lt;/span&gt;.
This scheme involves measuring the diameters of target solid tumour lesions and categorising the response as one of:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;complete response (CR), when all target lesions disappear completely;&lt;/li&gt;
&lt;li&gt;partial response (PR), when lesions shrink in aggregate by a threshold amount, but remain measureable;&lt;/li&gt;
&lt;li&gt;progressive disease (PD), when lesions grow in aggregate by a threshold amount;&lt;/li&gt;
&lt;li&gt;stable disease (SD), when neither CR, PR nor PD occurs.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are the RECIST criteria for assessing solid tumours.
Researchers have defined anlogues to these schemes in other cancers, including blood cancers where diseased cells reside in the blood rather than a discrete measurable tumour.
An example of this is the Cheson criteria in acute myeloid leukaemia (AML).&lt;/p&gt;
&lt;p&gt;Where reported, we recorded the incidence of these response categories by dose-level.&lt;/p&gt;
&lt;p&gt;Furthermore, researchers commonly derive additional outcomes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;objective response (OR), when CR or PR is observed;&lt;/li&gt;
&lt;li&gt;disease containment (DC), when CR, PR or SD occurs.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We recorded these outcomes where reported, and imputed them where the components were available.
This involved adjustments to the definition of OR and DC to suit the response scheme.
For example, an objective response in AML included &lt;em&gt;complete response with incomplete marrow recovery&lt;/em&gt;, a response category signifiying relative treatment success that does not exist in RECIST.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;orderability-of-doses&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Orderability of doses&lt;/h3&gt;
&lt;p&gt;Analysing how the probabilities of events change as dose increases requires that we are working with increasing doses.
The general 3+3, CRM and EWOC methods require that the doses under investigation are &lt;em&gt;fully orderable&lt;/em&gt;.
That is, we need to be able to unambiguously say that &lt;span class=&#34;math inline&#34;&gt;\(d_i &amp;lt; d_j\)&lt;/span&gt; or &lt;span class=&#34;math inline&#34;&gt;\(d_i &amp;gt; d_j\)&lt;/span&gt; for each &lt;span class=&#34;math inline&#34;&gt;\(d_i, d_j \in \mathcal{D} = \{ d_1, ..., d_n \}\)&lt;/span&gt; for &lt;span class=&#34;math inline&#34;&gt;\(i \neq j\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Despite this, we commonly encountered trials that used sets of doses that were not fully orderable.
When this happened, for the purposes of analysis, we broke the doses up to form fully orderable subsets that we called &lt;em&gt;analysis series&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;There are many possible subsets of a set so the way we formed these series was unavoidably subjective.
We sought to maximise the size of the largest fully orderable series.
Furthermore, we avoided allocating a dose to several series unless repetition was the only way to avoid having an orphan dose (i.e. a series of size 1).&lt;/p&gt;
&lt;p&gt;In summary, the data have been recorded in a way amenable to answering the research questions.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;data-extraction&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Data extraction&lt;/h2&gt;
&lt;p&gt;Data were extracted from papers and recorded on a prior-written standardised form, with one form for each manuscript.
The data were then recorded on sheets in an Excel file that was deposited in the University of Birmingham’s data repository.
Details on accessing the data are given below.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;results&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Results&lt;/h1&gt;
&lt;div id=&#34;data-presence&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Data presence&lt;/h2&gt;
&lt;p&gt;We can load the datasets by running:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;source(&amp;#39;https://raw.githubusercontent.com/brockk/dosefindingdata/master/Load.R&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The script above hosted on GitHub:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;loads the &lt;code&gt;readxl&lt;/code&gt;, &lt;code&gt;httr&lt;/code&gt;, &lt;code&gt;dplyr&lt;/code&gt;, and &lt;code&gt;stringr&lt;/code&gt; packages;&lt;/li&gt;
&lt;li&gt;downloads the raw data file from the data repository;&lt;/li&gt;
&lt;li&gt;joins the raw datasets to create datasets useful for analysis.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We can check the number of manuscripts:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)

manuscripts %&amp;gt;% nrow&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 122&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and the number of studies:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;studies %&amp;gt;% nrow&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 139&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There are more studies than manuscripts because some manuscripts report results from more than one dose-finding experiment.&lt;/p&gt;
&lt;p&gt;Characteristic data was available for every manuscript.
The clear majority of studies report toxicity outcomes by dose:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;studies %&amp;gt;% count(ToxByDose)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 2
##   ToxByDose     n
##   &amp;lt;lgl&amp;gt;     &amp;lt;int&amp;gt;
## 1 FALSE         6
## 2 TRUE        133&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Substantially fewer report efficacy outcomes by dose:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;studies %&amp;gt;% count(EffByDose)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 2
##   EffByDose     n
##   &amp;lt;lgl&amp;gt;     &amp;lt;int&amp;gt;
## 1 FALSE        54
## 2 TRUE         85&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The five outcomes reported most commonly are:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;binary_events %&amp;gt;% 
  left_join(studies, by = &amp;#39;Study&amp;#39;) %&amp;gt;% 
  left_join(outcomes, by = &amp;#39;OutcomeId&amp;#39;) %&amp;gt;% 
  group_by(OutcomeClass, Outcome = OutcomeText) %&amp;gt;% 
  summarise(
    NumObs = n(), 
    NumStudies = length(unique(Study))
    ) %&amp;gt;% 
  mutate(ObsPerStudy = NumObs / NumStudies) %&amp;gt;% 
  arrange(-NumObs) %&amp;gt;% 
  head(5) %&amp;gt;% 
  knitr::kable(digits = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;OutcomeClass&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;Outcome&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;NumObs&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;NumStudies&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;ObsPerStudy&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Safety&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Patients with DLT&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;648&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;131&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Efficacy&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Patients with Objective Response by RECIST&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;273&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;54&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Efficacy&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Patients with Disease Control by RECIST&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;223&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Efficacy&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Patients with Best response SD by RECIST&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;222&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Efficacy&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;Patients with Best response PD by RECIST&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;170&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.7&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We see that DLT is reported in the great majority of studies.
The most commonly-reported efficacy outcome is objective response by RECIST.
As described above, this outcome is only relevant in solid tumour settings.&lt;/p&gt;
&lt;p&gt;It was frustratingly common that toxicity would be reported by dose-level but efficacy would only be reported for all doses combined.
Naturally this impinges our ability to answer the research question.&lt;/p&gt;
&lt;p&gt;We found no papers reporting OS or PFS by dose-level.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;discussion&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Discussion&lt;/h1&gt;
&lt;p&gt;This post introduced a substantial dataset on outcomes from dose-finding clinical trials.
It showed how to load the dataset and derive a few simple summary statistics on the number of studies and the frequency with which outcomes were reported.
Actually doing something useful with the data will be the subject of further posts.
For now, this post continues below with a full description of the data files.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;availability-of-data&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Availability of data&lt;/h1&gt;
&lt;p&gt;The datasets are available to download from &lt;a href=&#34;https://edata.bham.ac.uk/337/&#34; class=&#34;uri&#34;&gt;https://edata.bham.ac.uk/337/&lt;/a&gt;.
A full specification of the file format is give below.&lt;/p&gt;
&lt;p&gt;If you use the data, please cite:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Kristian Brock, Victoria Homer, Gurjinder Soul, Claire Potter, Cody Chiuzan and Shing Lee “Dose-level toxicity and efficacy outcomes from dose-finding clinical trials in oncology”. 2019. doi: 10.25500/edata.bham.00000337&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;or use the following BibTex entry:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@misc{BrockDoseFindingData,
    author = {Kristian Brock and Victoria Homer and Gurjinder Soul and Claire Potter and Cody Chiuzan and Shing Lee},
    year = {2019},
    title = {Dose-level toxicity and efficacy outcomes from dose-finding clinical trials in oncology},
    doi = {10.25500/edata.bham.00000337},
    howpublished= {\url{https://doi.org/10.25500/edata.bham.00000337}},
    timestamp = {2019.05.05}
}&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;fast-loading-into-r&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Fast loading into R&lt;/h2&gt;
&lt;p&gt;As demonstrated above, the fastest way to get the data loaded into R is to run the command:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;source(&amp;#39;https://raw.githubusercontent.com/brockk/dosefindingdata/master/Load.R&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, that runs code I have written on your machine so it requires that you trust me not to turn your computer into a bitcoin-mining drone in my distributed e-wealth empire.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;full-description-of-database-format&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Full description of database format&lt;/h1&gt;
&lt;p&gt;The file is called &lt;code&gt;database.xlsx&lt;/code&gt; and it contains many tabs.
The following sections describe in depth the format of the file.&lt;/p&gt;
&lt;div id=&#34;manuscripts&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Manuscripts&lt;/h2&gt;
&lt;p&gt;This tab details the manuscripts studied in this research.&lt;/p&gt;
&lt;p&gt;Columns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Manuscript&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Primary key for the manuscript in this project.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Year&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: Year manuscript was published.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DOI&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Manuscript DOI.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Source&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: How the manuscript came to be in the database. Options are:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ChiuzanModelBased&lt;/code&gt;, listed in &lt;span class=&#34;citation&#34;&gt;Chiuzan et al. (2017)&lt;/span&gt; as a trial using a model-based dose-finding design.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ChiuzanRuleBased1&lt;/code&gt;, randomly selected from the unpublished list of trials using rule-based dose-finding designs assembled by &lt;span class=&#34;citation&#34;&gt;Chiuzan et al. (2017)&lt;/span&gt; during their review.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SupplementAppendix&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if manuscript has a supplement or appendix.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DataExtraction1&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Person who extracted the data.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DataExtraction2&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Person who extracted the data a second time or checked the first extraction.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AddToDB&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: TRUE if data has been added to the database.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Note&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Items noted during data extraction.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;studies&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Studies&lt;/h2&gt;
&lt;p&gt;In this database, a &lt;code&gt;Study&lt;/code&gt; is an abstract concept encapsulating:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a set of doses of some treatment or combination of treatments;&lt;/li&gt;
&lt;li&gt;given to patients;&lt;/li&gt;
&lt;li&gt;yielding outcome data.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In a simple scenario, one manuscript would contain one Study.
However, there can be multiple Studies in a manuscript.
For example, if more than treatment or treatment combination is the subject of dose investigation in a single manuscript, they are seperate studies.&lt;/p&gt;
&lt;p&gt;Columns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Manuscript&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Foreign key to Manuscripts, reflecting the manuscript that reported the data.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Study&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Primary key for the study in this project.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PatientGroup&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: brief description of the patient group.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PatientGroupDetailed&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: more detailed description of the patient group.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HaemNonhaem&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Options are:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Haematological&lt;/code&gt;, if the disease under study was haematological, like leukaemia or lymphoma.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NonHaematological&lt;/code&gt;, if the disease under study was solid tumour and therefore non-haematological, like lung cancer.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Mixed&lt;/code&gt;, if both disease types were studied.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Unknown&lt;/code&gt;, where not specified.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Treatment&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: brief description of all treatments given, whether dose-varying or not.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ContainsChemo&lt;/code&gt;, &lt;code&gt;bit&lt;/code&gt;: &lt;code&gt;1&lt;/code&gt; if the treatment contains any chemotherapy element, fixed-dose or dose-varying. A full decomposition of treatment types is not provided here (e.g. there is no ContainsInhibitor field) but standardised types of the dose-varying treatment(s) are given in the column DoseVaryingTreatmentType.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FixedDoseChemo&lt;/code&gt;, &lt;code&gt;bit&lt;/code&gt;: &lt;code&gt;1&lt;/code&gt; if the treatment contains a fixed-dose chemotherapy component; &lt;code&gt;0&lt;/code&gt; if there is no fixed-dose chemo element. Note if chemotherapy is included only as part of the investigative treatment and thus has its dose varied, this field will be &lt;code&gt;0&lt;/code&gt;. This field is provided to address the reasonable expectation that the presence of a standard chemotherapy backbone increases the expectation of toxicity. A special case is made here for chemo to allow an analysis to reflect the reasonably-expected population-level effect that chemotherapy is associated with greater toxicity (and perhaps also response).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DoseVaryingTreatment&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: the treatment(s) that have their dose varied. In the case of many treatments, items are separated by the + symbol. Any treatment identified in Treatment but not in DoseVaryingTreatment can be assumed to be constant across the doses under investigation.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DoseVaryingTreatmentType&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: type of the treatment(s) undergoing dose variation. Options are:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Cell therapy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Chemoprevention&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Chemotherapy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Cytokine&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GeneTherapy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Immunomodulatory drug&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Inhibitor&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Monoclonal Antibody&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Not disclosed&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Oncolytic virus&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Radiopharmaceutical&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Radiotherapy&lt;/code&gt;
or combinations thereof.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DoseVaryingTreatmentTypeDetail&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: more detailed and precise description of the type of dose-varying treatment, provided where available.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MultiVarying&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if the dose of several treatments was varied.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MonotonicDoses&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if the doses investigated are monotonically increasing.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DoseUnits&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: the units of the doses.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MTDorRP2D&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: the dose recommended as the MTD or RP2D.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ToxByDose&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if toxicity outcomes were reported by dose.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;EffByDose&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if efficacy outcomes were reported by dose.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AdverseEventLevelCounts&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if adverse events were tabulated by dose for specific events (e.g. Anaemia) in contrast to the broad level (e.g. Grade 3/4 AE).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;outcomes&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Outcomes&lt;/h2&gt;
&lt;p&gt;This tab details the outcome measures collected from the manuscripts.&lt;/p&gt;
&lt;p&gt;Columns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;OutcomeId&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: Primary key for the outcome measure in this project.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OutcomeText&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Description of the outcome measure.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OutcomeClass&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Class of the outcome measure. Options are:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Safety&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Efficacy&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Include&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: This may be deprecated.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;HighIsGood&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if a high value is a good thing for patients. FALSE otherwise. E.g. high response rate is good and low toxicity rate is good.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PerPatientOutcome&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if the outcome measure is binary at the patient level, e.g. “Any AE” is binary at the patient-level because a patient either experiences any AE (in which case it is &lt;code&gt;TRUE&lt;/code&gt;) or they do not (in which case it is &lt;code&gt;FALSE&lt;/code&gt;). In contrast, “Total AEs” is not binary because a patient may experience many AEs.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Note&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Items noted during data extraction.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;binaryoutcomeevents&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;BinaryOutcomeEvents&lt;/h2&gt;
&lt;p&gt;This tab contains the data extracted from manuscripts on binary outcome measures.&lt;/p&gt;
&lt;p&gt;Columns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Study&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Foreign key to Studies tab.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Dose&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Description of dose as reported. In the main, this is just a number, and simple to interpret. In more complicated scenarios, it could contain information reflecting: the frequency that treatments were given; several doses reported together like “10mg - 25mg” (an irritating practice - please do not do this); or doses for several treatments. The bewildering variety in this field is what encouraged us to think about &lt;em&gt;dose-levels&lt;/em&gt; (rather than actual doses) in monontonically increasing series.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OutcomeId&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: Foreign key to Outcomes tab.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;n&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: Number of patients. The denominator in a binary event rate.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Events&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: number of events.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Orphaned&lt;/code&gt;, &lt;code&gt;bool&lt;/code&gt;: &lt;code&gt;TRUE&lt;/code&gt; if the dose-level is orphaned and therefore has no unambiguous comparator.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;binaryoutcomeanalyisseries&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;BinaryOutcomeAnalyisSeries&lt;/h2&gt;
&lt;p&gt;Doses investigated and reported in clinial trials are not always monotonically increasing, despite the fact that they should be under the most commonly-used experimental designs like 3+3 and CRM. Blithely analysing all of the doses as they are reported in publications would sometimes create scenarios where it is impossible to definitively say whether a dose is greater or less than some other (e.g. “5mg per day” vs “10mg every second day”; or “10mg of A + 5mg of B” vs “5mg of A + 10mg of B”).&lt;/p&gt;
&lt;p&gt;An analysis-series is a set of doses from a particular study that are strictly monotonically increasing, evaluated with respect to a particular outcome measure. There are many ways to create such subsets. The analysis series presented here are merely those preferred by the author. They favour series with as many doses as possible (whilst still retaining unambiguous monotonic order) and as little repetition as possible. A small amount of repetition has been tolerated where necessary to avoid an “orphaned” dose-level, i.e. a dose-level with no comparator.&lt;/p&gt;
&lt;p&gt;You are free to create our own analysis-series if you prefer.&lt;/p&gt;
&lt;p&gt;Columns:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;NewSeries&lt;/code&gt;, &lt;code&gt;bit&lt;/code&gt;: This field exists to automate the generation of &lt;code&gt;AnalysisSeriesId&lt;/code&gt; and &lt;code&gt;Order&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AnalysisSeriesId&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: Primary key for the analysis series. Automatically generated by simple logic in Excel.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Order&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: The order of the dose in this analysis-series. Automatically generated by simple logic in Excel.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Study&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Foreign key to Studies tab.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Dose&lt;/code&gt;, &lt;code&gt;string&lt;/code&gt;: Description of dose as reported. In the main, this is just a number, and simple to interpret. In more complicated scenarios, it could contain information reflecting: the frequency that treatments were given; several doses reported together like “10mg - 25mg” (an irritating practice - please do not do this); or doses for several treatments. The bewildering variety in this field is what encouraged us to think about &lt;em&gt;dose-levels&lt;/em&gt; (rather than actual doses) in monontonically increasing series.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OutcomeId&lt;/code&gt;, &lt;code&gt;int&lt;/code&gt;: Foreign key to Outcomes tab.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level1 unnumbered&#34;&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-Chiuzan2017&#34;&gt;
&lt;p&gt;Chiuzan, Cody, Jonathan Shtaynberger, Gulam A. Manji, Jimmy K. Duong, Gary K. Schwartz, Anastasia Ivanova, and Shing M. Lee. 2017. “Dose-Finding Designs for Trials of Molecularly Targeted Agents and Immunotherapies.” &lt;em&gt;Journal of Biopharmaceutical Statistics&lt;/em&gt; 27 (3): 477–94. &lt;a href=&#34;https://doi.org/10.1080/10543406.2017.1289952&#34;&gt;https://doi.org/10.1080/10543406.2017.1289952&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Eisenhauer2009&#34;&gt;
&lt;p&gt;Eisenhauer, E. A., P. Therasse, J. Bogaerts, L. H. Schwartz, D. Sargent, R. Ford, J. Dancey, et al. 2009. “New Response Evaluation Criteria in Solid Tumours: Revised RECIST Guideline (Version 1.1).” &lt;em&gt;European Journal of Cancer&lt;/em&gt; 45 (2): 228–47. &lt;a href=&#34;https://doi.org/10.1016/j.ejca.2008.10.026&#34;&gt;https://doi.org/10.1016/j.ejca.2008.10.026&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-OQuigley1990&#34;&gt;
&lt;p&gt;O’Quigley, J, M Pepe, and L Fisher. 1990. “Continual Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.” &lt;em&gt;Biometrics&lt;/em&gt; 46 (1): 33–48. &lt;a href=&#34;https://doi.org/10.2307/2531628&#34;&gt;https://doi.org/10.2307/2531628&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Rogatko2007&#34;&gt;
&lt;p&gt;Rogatko, André, David Schoeneck, William Jonas, Mourad Tighiouart, Fadlo R. Khuri, and Alan Porter. 2007. “Translation of Innovative Designs into Phase I Trials.” &lt;em&gt;Journal of Clinical Oncology&lt;/em&gt; 25 (31): 4982–6. &lt;a href=&#34;https://doi.org/10.1200/JCO.2007.12.1012&#34;&gt;https://doi.org/10.1200/JCO.2007.12.1012&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Tighiouart2010&#34;&gt;
&lt;p&gt;Tighiouart, Mourad, and André Rogatko. 2010. “Dose Finding with Escalation with Overdose Control (EWOC) in Cancer Clinical Trials.” &lt;em&gt;Statistical Science&lt;/em&gt; 25 (2): 217–26. &lt;a href=&#34;https://doi.org/10.1214/10-STS333&#34;&gt;https://doi.org/10.1214/10-STS333&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Simulation or enumeration with dose-finding designs?</title>
      <link>https://www.kristianbrock.com/post/simulate-vs-enumerate-dose-finding/</link>
      <pubDate>Thu, 23 Apr 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/simulate-vs-enumerate-dose-finding/</guid>
      <description>
&lt;script src=&#34;https://www.kristianbrock.com/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.kristianbrock.com/rmarkdown-libs/viz/viz.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.kristianbrock.com/rmarkdown-libs/DiagrammeR-styles/styles.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://www.kristianbrock.com/rmarkdown-libs/grViz-binding/grViz.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;introduction&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;If operating performance of a dose-finding clinical trial design is sought, it is practically guaranteed that this will be by computer simulation.
In a dose-finding simulation, a dose is initially selected and toxicity (and perhaps also efficacy) outcomes are sampled according to some assumed true event probabilities to generate data for some imaginary patients.
The model is fit to the data and the subsequent dose recommendation is given to the next group of imaginary patients.
This iterative and adaptive process continues to conduct a virtual trial.
In this manner, many virtual trials are run to inform the trialists of the operating performance of the design.&lt;/p&gt;
&lt;p&gt;However, simulating random virtual trials is not the only way to measure operating performance.
&lt;a href=&#34;https://elevanth.org/blog/2017/11/28/build-a-better-markov-chain/&#34;&gt;Richard McElreath said&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If there’s a random way to do something, there’s usually a less random way that is both better and requires more thought.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In dose-finding trials, a less random method is to calculate each trial path using brute force.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;simple-example&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Simple example&lt;/h2&gt;
&lt;p&gt;I demonstrated dose paths &lt;span class=&#34;citation&#34;&gt;(Yap et al. 2017; Brock et al. 2017)&lt;/span&gt; in a &lt;a href=&#34;https://www.kristianbrock.com/post/dose-paths/&#34;&gt;recent post&lt;/a&gt; using the &lt;code&gt;escalation&lt;/code&gt; package.
Let us walk through a simple example to see how dose-paths and simulation can be used to calculate operating characteristics for a dose-finding trial design.&lt;/p&gt;
&lt;p&gt;We load the escalation package:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(escalation)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: magrittr&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For the sake of illustration, let us use:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a continual reassessment method (CRM) design&lt;/li&gt;
&lt;li&gt;in a three-dose setting&lt;/li&gt;
&lt;li&gt;to target a toxicity rate of 25%&lt;/li&gt;
&lt;li&gt;with a dose-toxicity skeleton that anticipates the middle dose is the sought dose:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;target &amp;lt;- 0.25
skeleton &amp;lt;- dfcrm::getprior(0.1, target = target, nu = 2, nlevel = 3)

model &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;% 
        stop_at_n(n = 6)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We told the model above to stop when the total sample size reached six patients.
Obviously, real trials would generally use larger sample sizes, but six patients will be enough for our illustrative example.&lt;/p&gt;
&lt;p&gt;Let us start the trial at the second dose and calculate all possible dose paths for two cohorts of three patients:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- model %&amp;gt;% get_dose_paths(cohort_sizes = rep(3, 2), next_dose = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Viewing the paths makes clear that the decision space is finite and tractable to exact calculation of probabilities:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;graph_paths(paths)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:720px;height:720px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#35B779FF\&#34;] \n  \&#34;2\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#31688EFF\&#34;, fillcolor = \&#34;#FDE725FF\&#34;] \n  \&#34;3\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#31688EFF\&#34;, fillcolor = \&#34;#FDE725FF\&#34;] \n  \&#34;4\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#35B779FF\&#34;] \n  \&#34;5\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#35B779FF\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;8\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;9\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;10\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#31688EFF\&#34;, fillcolor = \&#34;#FDE725FF\&#34;] \n  \&#34;11\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#35B779FF\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;14\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#35B779FF\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;16\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;17\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;18\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;19\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;20\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n  \&#34;21\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#31688EFF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NNT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NNT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;15\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;16\&#34; [label = \&#34;NTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;17\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;18\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;19\&#34; [label = \&#34;TTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;20\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;21\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;Our first instinct might tell us that there are lots of terminal nodes that recommend dose 1 and relatively few that recommend dose 3.
We might then infer that selecting dose 1 is likely.
In fact, if the true toxicity probabilities at the three doses are (10%, 17%, 25%), we can calculate the exact operating performance:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;probs &amp;lt;- c(0.10, 0.17, 0.25)
cdp &amp;lt;- paths %&amp;gt;% calculate_probabilities(true_prob_tox = probs)
prob_recommend(cdp)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    NoDose         1         2         3 
## 0.0000000 0.1128170 0.4047377 0.4824453&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;to learn that there is a 40.5% chance that the second dose will be recommended, and a 48.2% chance that the third dose will be recommended.&lt;/p&gt;
&lt;p&gt;The object name &lt;em&gt;cdp&lt;/em&gt; stands for &lt;em&gt;crystallised dose paths&lt;/em&gt;, my name for paths that have associated exact probabilities.
Simply printing the object to the console:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cdp&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Number of nodes: 21 
## Number of terminal nodes: 16 
## 
## Number of doses: 3 
## 
## True probability of toxicity:
##    1    2    3 
## 0.10 0.17 0.25 
## 
## Probability of recommendation:
## NoDose      1      2      3 
##  0.000  0.113  0.405  0.482 
## 
## Probability of continuance:
## [1] 0
## 
## Probability of administration:
##      1      2      3 
## 0.0384 0.6757 0.2859 
## 
## Expected sample size:
## [1] 6
## 
## Expected total toxicities:
## [1] 1.141085&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;confirms the recommendation probabilities and many other statistics.&lt;/p&gt;
&lt;p&gt;The more common way to estimate dose-finding design performance is via simulation.
&lt;code&gt;escalation&lt;/code&gt; supports simulation too:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sims100 &amp;lt;- model %&amp;gt;% 
  simulate_trials(num_sims = 100, true_prob_tox = probs, next_dose = 2)

sims1000 &amp;lt;- model %&amp;gt;% 
  simulate_trials(num_sims = 1000, true_prob_tox = probs, next_dose = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;These, too, will estimate the probability that each dose will be recommended when the trial is done:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;prob_recommend(sims100)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## NoDose      1      2      3 
##   0.00   0.15   0.40   0.45&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;prob_recommend(sims1000)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## NoDose      1      2      3 
##  0.000  0.112  0.420  0.468&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;However, the inferences from the simulations are subject to Monte Carlo error because we have used a finite number of samples to estimate an unknown probability.
If we collate the inferences from the dose-paths and simulations:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tibble)
library(dplyr)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;trial_inference &amp;lt;- function(x, n) {
  dose_labs &amp;lt;- c(&amp;#39;NoDose&amp;#39;, dose_indices(x))
  tibble(Dose = dose_labs, ProbRecommend = prob_recommend(x), N = n) %&amp;gt;% 
    mutate(
      ProbRecommendSE = sqrt(ProbRecommend * (1 - ProbRecommend) / N),
      ProbRecommendL = ProbRecommend - 2 * ProbRecommendSE,
      ProbRecommendU = ProbRecommend + 2 * ProbRecommendSE
    )
}

inference &amp;lt;- bind_rows(
  trial_inference(cdp, n = Inf) %&amp;gt;% mutate(Method = &amp;#39;Exact&amp;#39;),
  trial_inference(sims100, n = 100) %&amp;gt;% mutate(Method = &amp;#39;Sims (N=100)&amp;#39;),
  trial_inference(sims1000, n = 1000) %&amp;gt;% mutate(Method = &amp;#39;Sims (N=1000)&amp;#39;),
) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;we see the extent and effect of that estimation error:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
inference %&amp;gt;% 
  ggplot(aes(x = Dose, y = ProbRecommend, col = Method)) + 
  geom_point(position = position_dodge(width = 0.3)) + 
  geom_errorbar(aes(ymin = ProbRecommendL, ymax = ProbRecommendU), 
                width = 0.1, position = position_dodge(width = 0.3))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/simulate-vs-enumerate-dose-finding/index_files/figure-html/unnamed-chunk-11-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;As we might anticipate, the simulation method is hopelessly imprecise with &lt;span class=&#34;math inline&#34;&gt;\(N=100\)&lt;/span&gt; iterations.
In contrast the simulations with &lt;span class=&#34;math inline&#34;&gt;\(N=1000\)&lt;/span&gt; iterations are fairly precise.&lt;/p&gt;
&lt;p&gt;Each simulated trial required that the dose selection model be fit twice, once at the end of each of the two cohorts.
A simulation study with 1000 iterations thus required 2000 model fits.
We might justifiably conclude that &lt;em&gt;fairly precise&lt;/em&gt; is a comparatively bad return on 2000 model invocations when the exact inferences from the dose paths required precisely 21 model fits, one for each of the nodes in the graph above.&lt;/p&gt;
&lt;p&gt;Dose paths are more precise than simulations because they are free from the Monte Carlo error that clouds inferences from simulations.
In this toy scenario, the paths method was also vastly more efficient, requiring only a small fraction of the model fits.&lt;/p&gt;
&lt;p&gt;However, this contrived example is unlikely to be representative of real trial scenarios, where we would expect much higher sample sizes.
This invites the question, how far can the dose paths method be taken?
When does it become more efficient to run simulations than attempting a brute force calculation?&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;calculating-paths-at-scale&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Calculating paths at scale&lt;/h2&gt;
&lt;p&gt;Contrasting the computational efficiency of dose paths and simulations requires calculating the number of model invocations expected by each.&lt;/p&gt;
&lt;p&gt;For simulations, the arithmetic is simple.
Investigating a dose-finding trial of &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; cohorts in a single scenario using a simulation study with &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; replicates requires &lt;span class=&#34;math inline&#34;&gt;\(MN\)&lt;/span&gt; model invocations.
For example, a trial of &lt;span class=&#34;math inline&#34;&gt;\(n=30\)&lt;/span&gt; patients evaluated in 10 cohorts requires 10 model invocations, so 1000 simulated replicates requires &lt;span class=&#34;math inline&#34;&gt;\(10 \times 1000 = 10000\)&lt;/span&gt; model fits in total.&lt;/p&gt;
&lt;p&gt;In a dose paths analysis, the model must be fit once for each node in the graph.
The number of nodes in a dose paths analysis is slightly more complex to calculate (but only slightly).
Let &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; be the number of distinct outcomes a single patient may experience.
In a phase I trial using the CRM, each patient may experience toxicity (T) or no toxicity (N), so &lt;span class=&#34;math inline&#34;&gt;\(k= 2\)&lt;/span&gt;.
The number of outcome combinations in a cohort of &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; patients is&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ \frac{(m + k - 1)!}{m! (k - 1)!} \]&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;For instance, a cohort of three patients has four possible outcomes: NNN, NNT, NTT, or TTT.
The formula above gives &lt;span class=&#34;math inline&#34;&gt;\((3 + 2 - 1)! / 3! (2 - 1)! = 4\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;That is the number of outcomes of a single cohort.
The number of nodes at depth &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; in a graph of dose paths is equal to the number of nodes at depth &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; multiplied by the number of cohort outcomes at depth &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;.
There is always one node at depth 1 at the centre of the graph.
For a cohort of three in a CRM trial, we saw above that there are four possible outcomes.
Thus, at depth 2, there are 4 nodes and at depth 2 there are 16 nodes, etc.&lt;/p&gt;
&lt;p&gt;Naturally, the cohort sizes may be irregular.
In general, the number of nodes at depth &lt;span class=&#34;math inline&#34;&gt;\(I\)&lt;/span&gt; for cohort sizes &lt;span class=&#34;math inline&#34;&gt;\((m_1, ..., m_I)\)&lt;/span&gt; is&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ \prod_{i=1}^I \frac{(m_i + k - 1)!}{m_i! (k - 1)!} \]&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Fortunately, there is a function in &lt;code&gt;escalation&lt;/code&gt; that calculates the number of nodes in a dose paths analysis.
Our simple example with &lt;span class=&#34;math inline&#34;&gt;\(n=6\)&lt;/span&gt; patients conducted in two cohorts of three has:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;num_dose_path_nodes(num_patient_outcomes = 2, cohort_sizes = c(3, 3))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1]  1  4 16&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;nodes at depths, 1, 2, and 3, respectively.
The total number of model invocations is the total number of nodes, which is 21, as required.&lt;/p&gt;
&lt;p&gt;We can use the function to calculate the number of nodes in an &lt;span class=&#34;math inline&#34;&gt;\(n=30\)&lt;/span&gt; trial with 10 cohorts of three patients:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;n &amp;lt;- num_dose_path_nodes(num_patient_outcomes = 2, cohort_sizes = rep(3, 10))
n&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]       1       4      16      64     256    1024    4096   16384   65536
## [10]  262144 1048576&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The number of nodes increases exponentially in graph depth.
The total number of model fits is:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sum(n)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1398101&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;1.4m model fits is a substantial computational burden.&lt;/p&gt;
&lt;p&gt;Clearly dose number of nodes has increased dramatically as the number of cohorts has increased.
Let’s calculate the number of nodes contained in dose-paths of &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; cohorts of 3, for increasing values of M:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cohort_size &amp;lt;- 3
num_cohorts &amp;lt;- c(2, 3, 4, 5, 6, 7, 8, 9, 10) %&amp;gt;% as.integer()

library(purrr)
num_model_fits &amp;lt;- map_int(
  num_cohorts, 
  ~ num_dose_path_nodes(num_patient_outcomes = 2, 
                        cohort_sizes = rep(cohort_size, .x)) %&amp;gt;% sum()
)

num_model_fits&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1]      21      85     341    1365    5461   21845   87381  349525 1398101&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;THese numbers are the total number of nodes.
The final value confirms that roughly 1.4m nodes feature in a graph of paths for eight cohorts of 3 patients.
Let’s view those numbers of model invocations alongside the equivalent for simulations with &lt;span class=&#34;math inline&#34;&gt;\(N=1000\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(10000\)&lt;/span&gt; replicates:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;bind_rows(
  tibble(NumCohorts = num_cohorts,
         NumModelFits = num_model_fits,
         Method = &amp;#39;Paths&amp;#39;),
  tibble(NumCohorts = num_cohorts,
         NumModelFits = 1000 * num_cohorts,
         Method = &amp;#39;Sims (N=1000)&amp;#39;),
  tibble(NumCohorts = num_cohorts,
         NumModelFits = 10000 * num_cohorts,
         Method = &amp;#39;Sims (N=10000)&amp;#39;),
) %&amp;gt;% 
  ggplot(aes(x = NumCohorts, y = NumModelFits, col = Method)) + 
  geom_point() + 
  geom_line() + 
  scale_y_log10() + 
  labs(y = &amp;#39;Number of model fits&amp;#39;, x = &amp;#39;Number of cohorts of 3 patients&amp;#39;,
       title = &amp;#39;Computational burden of dose paths and simulation&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/simulate-vs-enumerate-dose-finding/index_files/figure-html/unnamed-chunk-16-1.png&#34; width=&#34;720&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;-axis on the plot above is on the log-scale.
We see that the number of model fits in the dose paths analysis increases exponentially in the number of cohorts, as expected.
In contrast, the number of model fits required by simulations increases linearly in the number of cohorts, generally from a much higher base.
The result is that the paths analysis is more computationally efficient than simulations:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;with &lt;span class=&#34;math inline&#34;&gt;\(N=1000\)&lt;/span&gt; iterations when there are fewer than 6 cohorts of 3;&lt;/li&gt;
&lt;li&gt;with &lt;span class=&#34;math inline&#34;&gt;\(N=10000\)&lt;/span&gt; iterations when there are fewer than 8 cohorts of 3.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Perhaps we do not plan to use cohorts, intending instead to update the dose recommendation after each patient.
We can calculate the computational burdens in this situation:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;cohort_size &amp;lt;- 1
num_cohorts &amp;lt;- seq(from = 1, to = 30, by = 1)

num_model_fits &amp;lt;- map_int(
  num_cohorts, 
  ~ num_dose_path_nodes(num_patient_outcomes = 2, 
                        cohort_sizes = rep(cohort_size, .x)) %&amp;gt;% sum()
)

bind_rows(
  tibble(NumCohorts = num_cohorts,
         NumModelFits = num_model_fits,
         Method = &amp;#39;Paths&amp;#39;),
  tibble(NumCohorts = num_cohorts,
         NumModelFits = 1000 * num_cohorts,
         Method = &amp;#39;Sims (N=1000)&amp;#39;),
  tibble(NumCohorts = num_cohorts,
         NumModelFits = 10000 * num_cohorts,
         Method = &amp;#39;Sims (N=10000)&amp;#39;),
) %&amp;gt;% 
  ggplot(aes(x = NumCohorts, y = NumModelFits, col = Method)) + 
  geom_point() + 
  geom_line() + 
  scale_y_log10() + 
  labs(y = &amp;#39;Number of model fits&amp;#39;, x = &amp;#39;Number of patients&amp;#39;,
       title = &amp;#39;Computational burden of dose paths and simulation&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://www.kristianbrock.com/post/simulate-vs-enumerate-dose-finding/index_files/figure-html/unnamed-chunk-17-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Again, we see that paths are much more efficient for low sample sizes, but sample sizes in excess of 12 - 16 patients favour simulation.&lt;/p&gt;
&lt;p&gt;Assuming that dose-finding trials generally have sample sizes of 20-40 patients, that would seem to suggest that simulations clearly vanquish dose-paths for practical use.
However, there is one last major consideration to understand.&lt;/p&gt;
&lt;div id=&#34;dose-paths-can-be-recycled&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Dose paths can be recycled&lt;/h3&gt;
&lt;p&gt;The computational burdens are calculated above for &lt;em&gt;a single batch of simulations&lt;/em&gt; corresponding to a &lt;em&gt;single set of assumed outcome probabilities&lt;/em&gt;.
Generally, simulation studies to justify dose-finding designs use many scenarios.
On the number of scenarios to investigate, &lt;span class=&#34;citation&#34;&gt;Wheeler et al. (2019)&lt;/span&gt; advocate that:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;the simulation study should include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;scenarios where each dose is in fact the MTD;&lt;/li&gt;
&lt;li&gt;two extreme scenarios, in which the lowest dose is above the MTD and the highest dose is below the MTD;&lt;/li&gt;
&lt;li&gt;and any others that clinicians believe are plausible.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;where MTD means the &lt;em&gt;maximum tolerable dose&lt;/em&gt; or the notional target dose.
Thus, Wheeler &lt;em&gt;et al.&lt;/em&gt; advocate at least &lt;span class=&#34;math inline&#34;&gt;\(J + 2\)&lt;/span&gt; scenarios, where &lt;span class=&#34;math inline&#34;&gt;\(J\)&lt;/span&gt; is the number of doses under investigation.
The total computational burden for a simulation study of &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; scenarios is therefore bounded by &lt;span class=&#34;math inline&#34;&gt;\(NMS\)&lt;/span&gt;.
I say &lt;em&gt;bounded by&lt;/em&gt; rather than &lt;em&gt;equal to&lt;/em&gt; because some trials may stop early, depending on design.&lt;/p&gt;
&lt;p&gt;Simulations are arduous because in each scenario you start from scratch.
In stark contrast, dose-paths are reusable.
Calculating all dose paths is a relatively costly exercise.
But once they have been calculated, &lt;em&gt;crystallising&lt;/em&gt; the dose-paths with true outcome probabilities to calculate exact operating performance in a scenario is a relatively cheap computation.
The total computational burden under dose-paths will increase much slower than linearly in &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;.
Put another way, the time required to produce inference on one scenario is of the same order of magnitude as producing inference on many.
It pays to be thorough and with dose-paths, the incremental work to analyse an extra scenario is small.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The number of nodes in a graph of dose paths increases exponentially in the number of cohorts.
For 10 cohorts of three patients, approximately 10 times as many model fits are required in dose paths compared to simulations with &lt;span class=&#34;math inline&#34;&gt;\(N = 10000\)&lt;/span&gt; replicates (recall that the &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;-axes above are logarithmic).
That is, we expect simulations to be computationally cheaper here if fewer than 10 scenarios are investigated.
When the models are evaluated after each patient, dose-paths using &lt;span class=&#34;math inline&#34;&gt;\(n=30\)&lt;/span&gt; patients require more than &lt;span class=&#34;math inline&#34;&gt;\(10^3 = 1000\)&lt;/span&gt; times the number of model fits.
Simulations are clearly preferable here.&lt;/p&gt;
&lt;p&gt;However, we know that dose-paths are more precise.
Unlike the simulation method, inferences from dose paths are exact because they are free from Monte Carlo error.&lt;/p&gt;
&lt;p&gt;When investigating the operating performance of a clinical trial design, researchers spend computer time to increase certainty.
When deciding whether to perform inference via dose paths or simulation, I propose there are three situations:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;In trials with a small number of cohorts, dose-paths will be both faster and more precise and should naturally be the preferred method for inference.&lt;/li&gt;
&lt;li&gt;In trials with a modest number of cohorts and many scenarios to analyse, dose-paths will have a similar total computational burden to simulations.
In these situations, the extra precision of dose-paths will make them preferable.&lt;/li&gt;
&lt;li&gt;Finally there will be trials with a high number of cohorts where dose-paths are simply infeasible to calculate. Here, simulations will be preferred.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A way to investgate the value of the two methods in practice is, ironically, a simulation study.
This would require plausible assumptions on the number of model fits that should be expected in a trial and how many scenarios would be used to evaluate designs.
That feels like it needs a review of the literature but it will have to wait because today I am out of time.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-Brock2017a&#34;&gt;
&lt;p&gt;Brock, Kristian, Lucinda Billingham, Mhairi Copland, Shamyla Siddique, Mirjana Sirovica, and Christina Yap. 2017. “Implementing the EffTox Dose-Finding Design in the Matchpoint Trial.” &lt;em&gt;BMC Medical Research Methodology&lt;/em&gt; 17 (1): 112. &lt;a href=&#34;https://doi.org/10.1186/s12874-017-0381-x&#34;&gt;https://doi.org/10.1186/s12874-017-0381-x&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-wheelerHowDesignDosefinding2019&#34;&gt;
&lt;p&gt;Wheeler, Graham M., Adrian P. Mander, Alun Bedding, Kristian Brock, Victoria Cornelius, Andrew P. Grieve, Thomas Jaki, et al. 2019. “How to Design a Dose-Finding Study Using the Continual Reassessment Method.” &lt;em&gt;BMC Medical Research Methodology&lt;/em&gt; 19 (1). &lt;a href=&#34;https://doi.org/10.1186/s12874-018-0638-z&#34;&gt;https://doi.org/10.1186/s12874-018-0638-z&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Yap2017&#34;&gt;
&lt;p&gt;Yap, Christina, Lucinda J. Billingham, Ying Kuen Cheung, Charlie Craddock, and John O’Quigley. 2017. “Dose Transition Pathways: The Missing Link Between Complex Dose-Finding Designs and Simple Decision-Making.” &lt;em&gt;Clinical Cancer Research&lt;/em&gt; 23 (24): 7440–7. &lt;a href=&#34;https://doi.org/10.1158/1078-0432.CCR-17-0582&#34;&gt;https://doi.org/10.1158/1078-0432.CCR-17-0582&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Dose-paths in the escalation package</title>
      <link>https://www.kristianbrock.com/post/dose-paths/</link>
      <pubDate>Tue, 21 Apr 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/dose-paths/</guid>
      <description>
&lt;script src=&#34;https://www.kristianbrock.com/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://www.kristianbrock.com/rmarkdown-libs/viz/viz.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://www.kristianbrock.com/rmarkdown-libs/DiagrammeR-styles/styles.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://www.kristianbrock.com/rmarkdown-libs/grViz-binding/grViz.js&#34;&gt;&lt;/script&gt;


&lt;div id=&#34;introduction&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Dose-finding clinical trials investigate experimental agents, seeking doses that are tolerable and active.
They commonly use some dose-selection model to analyse binary outcomes at increasing doses in cohorts of patients.
It is possible to analyse the behaviour of a dose-finding design by exhaustively calculating every possible set of outcomes and invoking the dose selection model on each.
We will refer to these hypothetical sequences of doses in response to outcomes as &lt;em&gt;dose-paths&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;An example will make this clear.
The 3+3 design is widely understood.
One of its benefits is its simplicity.
Let us investigate the first two cohorts of three patients in the 3+3 variant that permits de-escalation.
We calculate dose-paths in &lt;code&gt;escalation&lt;/code&gt; using the &lt;code&gt;get_dose_paths&lt;/code&gt; function:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(escalation)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: magrittr&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_three_plus_three(num_doses = 5, allow_deescalate = TRUE) %&amp;gt;% 
  get_dose_paths(cohort_sizes = c(3, 3))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;get_dose_paths&lt;/code&gt; takes a dose-selection methodology and enumerates every possible path according to the cohort sizes that you specify.
The returned &lt;code&gt;paths&lt;/code&gt; object contains lot of information but the most pertinent perhaps is the sequence of dose-recommendations in response to hypothetical outcomes:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Give dose 1: 
##   NNN -&amp;gt; 2 
##     NNN -&amp;gt; 3 
##     NNT -&amp;gt; 2 
##     NTT -&amp;gt; 1 
##     TTT -&amp;gt; 1 
##   NNT -&amp;gt; 1 
##     NNN -&amp;gt; 2 
##     NNT -&amp;gt; NA 
##     NTT -&amp;gt; NA 
##     TTT -&amp;gt; NA 
##   NTT -&amp;gt; NA 
##   TTT -&amp;gt; NA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We see above that the trial starts at dose 1.
If three non-toxicities (N) are seen, the algorithm advocates escalation to dose 2.
In constrast if two or more toxicities (T) are seen in the first cohort, no dose is selected (the dose is &lt;code&gt;NA&lt;/code&gt;) and the trial stops.
Subsequent cohorts are represented by greater levels of indentation.&lt;/p&gt;
&lt;p&gt;This information is better represented by a graph.
If you are using RStudio, the graph will appear in the &lt;em&gt;Viewer&lt;/em&gt; pane.
(In this vignette, we suppress non-RStudio demonstration of the graphs to avoid problems on CRAN computers.)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;graph_paths(paths)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#7AD151FF\&#34;, fillcolor = \&#34;#414487FF\&#34;] \n  \&#34;2\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#2A788EFF\&#34;] \n  \&#34;3\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#22A884FF\&#34;] \n  \&#34;4\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#7AD151FF\&#34;, fillcolor = \&#34;#414487FF\&#34;] \n  \&#34;5\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#2A788EFF\&#34;] \n  \&#34;6\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#22A884FF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;7\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#22A884FF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;8\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#2A788EFF\&#34;] \n  \&#34;9\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#22A884FF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#7AD151FF\&#34;, fillcolor = \&#34;#414487FF\&#34;] \n  \&#34;11\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#22A884FF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#7AD151FF\&#34;, fillcolor = \&#34;#414487FF\&#34;] \n  \&#34;13\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#22A884FF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;1\&#34;-&gt;\&#34;7\&#34; [label = \&#34;TTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;8\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;12\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;13\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;The blue node towards the centre bearing the number &lt;code&gt;1&lt;/code&gt; represents the start of the trial.
The edges of the graph (the lines connecting the nodes) represent the outcomes in cohorts of patients.
As before, we see that if three &lt;code&gt;N&lt;/code&gt; events are seen, the trial escalates to dose 2.
Three patients are assumed to be treated at that dose and from there, further escalation to dose 3 will be advised if no toxicity is seen.
In contrast, dose 2 will be retained for a further cohort of three if a single toxicity is seen, and de-escalation to dose 1 will occur if two or more toxicities are seen.
This is exactly the behaviour we expect from the 3+3 design.&lt;/p&gt;
&lt;p&gt;Dose-paths were introduced in the phase I setting that we consider here by &lt;span class=&#34;citation&#34;&gt;Yap et al. (2017)&lt;/span&gt;.
Their phase I/II analogue was introduced by &lt;span class=&#34;citation&#34;&gt;Brock et al. (2017)&lt;/span&gt; for dose-finding trials that consider efficacy and toxicity outcomes.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;other-models&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Other Models&lt;/h1&gt;
&lt;div id=&#34;crm&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;CRM&lt;/h2&gt;
&lt;p&gt;The above example uses the 3+3 design but other methods are available.
In fact, early phase statisticians would much prefer that you use a model-based method &lt;span class=&#34;citation&#34;&gt;(Wheeler et al. 2019)&lt;/span&gt;.
The &lt;code&gt;escalation&lt;/code&gt; package is intentionally written so that all dose selectors look the same, regardless the implementation-level details.
In computing terminology, dose selectors in &lt;code&gt;escalation&lt;/code&gt; support a common interface.
This makes it trivial to calculate dose-paths for all dose-selectors - we just use the &lt;code&gt;get_dose_paths&lt;/code&gt; function again.&lt;/p&gt;
&lt;p&gt;Let us investigate a continual reassessment method (CRM) design now, as described by &lt;span class=&#34;citation&#34;&gt;O’Quigley, Pepe, and Fisher (1990)&lt;/span&gt; and implemented by the dfcrm package &lt;span class=&#34;citation&#34;&gt;(Cheung 2013)&lt;/span&gt;.
We must specify a dose-toxicity skeleton, and a target toxicity level:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skeleton &amp;lt;- c(0.05, 0.1, 0.25, 0.4, 0.6)
target &amp;lt;- 0.25&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can then specify a CRM model and calculate dose-paths as before:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;%
  get_dose_paths(cohort_sizes = c(3, 3))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When we graph the paths this time (and adopt a different colour palette for fun):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;graph_paths(paths, viridis_palette = &amp;#39;magma&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-2&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-2&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;2\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#3B0F70FF\&#34;, fillcolor = \&#34;#FE9F6DFF\&#34;] \n  \&#34;3\&#34; [label = \&#34;5\&#34;, fontcolor = \&#34;#8C2981FF\&#34;, fillcolor = \&#34;#FCFDBFFF\&#34;] \n  \&#34;4\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;5\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FCFDBFFF\&#34;, fillcolor = \&#34;#8C2981FF\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;8\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;9\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;10\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#000004FF\&#34;, fillcolor = \&#34;#DE4968FF\&#34;] \n  \&#34;11\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;14\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FCFDBFFF\&#34;, fillcolor = \&#34;#8C2981FF\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;16\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;17\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;18\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;19\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;20\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n  \&#34;21\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FE9F6DFF\&#34;, fillcolor = \&#34;#3B0F70FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NNT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NNT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;15\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;16\&#34; [label = \&#34;NTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;17\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;18\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;19\&#34; [label = \&#34;TTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;20\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;21\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;we see that the &lt;code&gt;Stop&lt;/code&gt; node is absent - all paths recommend a dose, even those seeing substantial toxicity.
Stopping behaviours must be specified for the CRM method.
Fortunately, &lt;code&gt;escalation&lt;/code&gt; makes this simple.&lt;/p&gt;
&lt;p&gt;An intuitive method for stopping in the Bayesian setting is to test the posterior distribution for the probability of toxicity.
In our example, we will stop if there is at least a 90% probability that the toxicity rate at the lowest dose is 35% or greater:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;%
  stop_when_too_toxic(dose = 1, tox_threshold = 0.35, confidence = 0.9) %&amp;gt;% 
  get_dose_paths(cohort_sizes = c(3, 3))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;When we visualise the paths from the updated model:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;graph_paths(paths, viridis_palette = &amp;#39;inferno&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-3&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-3&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;2\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#420A68FF\&#34;, fillcolor = \&#34;#FCA50AFF\&#34;] \n  \&#34;3\&#34; [label = \&#34;5\&#34;, fontcolor = \&#34;#932667FF\&#34;, fillcolor = \&#34;#FCFFA4FF\&#34;] \n  \&#34;4\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;5\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FCFFA4FF\&#34;, fillcolor = \&#34;#932667FF\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;8\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#DD513AFF\&#34;, fillcolor = \&#34;#000004FF\&#34;] \n  \&#34;9\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#000004FF\&#34;, fillcolor = \&#34;#DD513AFF\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;11\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;12\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FCFFA4FF\&#34;, fillcolor = \&#34;#932667FF\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;14\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;16\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA50AFF\&#34;, fillcolor = \&#34;#420A68FF\&#34;] \n  \&#34;17\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#DD513AFF\&#34;, fillcolor = \&#34;#000004FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;TTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NNT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;15\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;16\&#34; [label = \&#34;TTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;17\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;we see that some paths once again recommend stopping.
The paths that recommend a dose are otherwise unchanged.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;boin&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;BOIN&lt;/h2&gt;
&lt;p&gt;Another dose-escalation model implemented in &lt;code&gt;escalation&lt;/code&gt; is the Bayesian optimal interval (BOIN) method by &lt;span class=&#34;citation&#34;&gt;Liu and Yuan (2015)&lt;/span&gt;, implemented in the &lt;code&gt;BOIN&lt;/code&gt; package &lt;span class=&#34;citation&#34;&gt;(Yuan and Liu 2018)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;To spice things up, we will visualise how this model behaves over four cohorts of two patients:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_boin(num_doses = 4, target = target) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(2, 4))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## You have requested 121 model evaluations. Be patient.&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;graph_paths(paths, RColorBrewer_palette = &amp;#39;YlOrRd&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-4&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-4&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;2\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;3\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FFFFB2\&#34;, fillcolor = \&#34;#F03B20\&#34;] \n  \&#34;4\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#FECC5C\&#34;, fillcolor = \&#34;#BD0026\&#34;] \n  \&#34;5\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#FECC5C\&#34;, fillcolor = \&#34;#BD0026\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;8\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;9\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FFFFB2\&#34;, fillcolor = \&#34;#F03B20\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;11\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;14\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;15\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;16\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;17\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;18\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;19\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;20\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;21\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;22\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;23\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;24\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;25\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;26\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;27\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FFFFB2\&#34;, fillcolor = \&#34;#F03B20\&#34;] \n  \&#34;28\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;29\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;30\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;31\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;32\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;33\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;34\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;35\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;36\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;37\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;38\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;39\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FFFFB2\&#34;, fillcolor = \&#34;#F03B20\&#34;] \n  \&#34;40\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;41\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;42\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;43\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;44\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;45\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;46\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;47\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;48\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FFFFB2\&#34;, fillcolor = \&#34;#F03B20\&#34;] \n  \&#34;49\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;50\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;51\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;52\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;53\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;54\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;55\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;56\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;57\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;58\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;59\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;60\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#BD0026\&#34;, fillcolor = \&#34;#FD8D3C\&#34;] \n  \&#34;61\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;62\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;63\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;64\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FFFFB2\&#34;, fillcolor = \&#34;#F03B20\&#34;] \n  \&#34;65\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;66\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;67\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;68\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;69\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;70\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;71\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;72\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;73\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;74\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;75\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;76\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#F03B20\&#34;, fillcolor = \&#34;#FECC5C\&#34;] \n  \&#34;77\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;78\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n  \&#34;79\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#FD8D3C\&#34;, fillcolor = \&#34;#FFFFB2\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NN\&#34;] \n\&#34;3\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NN\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NN\&#34;] \n\&#34;7\&#34;-&gt;\&#34;8\&#34; [label = \&#34;NN\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;10\&#34; [label = \&#34;TT\&#34;] \n\&#34;10\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NN\&#34;] \n\&#34;11\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NN\&#34;] \n\&#34;12\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NT\&#34;] \n\&#34;14\&#34;-&gt;\&#34;15\&#34; [label = \&#34;NN\&#34;] \n\&#34;15\&#34;-&gt;\&#34;16\&#34; [label = \&#34;NN\&#34;] \n\&#34;6\&#34;-&gt;\&#34;17\&#34; [label = \&#34;NT\&#34;] \n\&#34;17\&#34;-&gt;\&#34;18\&#34; [label = \&#34;NN\&#34;] \n\&#34;18\&#34;-&gt;\&#34;19\&#34; [label = \&#34;NN\&#34;] \n\&#34;10\&#34;-&gt;\&#34;20\&#34; [label = \&#34;NT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;21\&#34; [label = \&#34;TT\&#34;] \n\&#34;21\&#34;-&gt;\&#34;22\&#34; [label = \&#34;NN\&#34;] \n\&#34;22\&#34;-&gt;\&#34;23\&#34; [label = \&#34;NN\&#34;] \n\&#34;6\&#34;-&gt;\&#34;24\&#34; [label = \&#34;TT\&#34;] \n\&#34;10\&#34;-&gt;\&#34;25\&#34; [label = \&#34;TT\&#34;] \n\&#34;3\&#34;-&gt;\&#34;26\&#34; [label = \&#34;NT\&#34;] \n\&#34;26\&#34;-&gt;\&#34;27\&#34; [label = \&#34;NN\&#34;] \n\&#34;7\&#34;-&gt;\&#34;28\&#34; [label = \&#34;NT\&#34;] \n\&#34;28\&#34;-&gt;\&#34;29\&#34; [label = \&#34;NN\&#34;] \n\&#34;11\&#34;-&gt;\&#34;30\&#34; [label = \&#34;NT\&#34;] \n\&#34;30\&#34;-&gt;\&#34;31\&#34; [label = \&#34;NN\&#34;] \n\&#34;14\&#34;-&gt;\&#34;32\&#34; [label = \&#34;NT\&#34;] \n\&#34;32\&#34;-&gt;\&#34;33\&#34; [label = \&#34;NN\&#34;] \n\&#34;17\&#34;-&gt;\&#34;34\&#34; [label = \&#34;NT\&#34;] \n\&#34;34\&#34;-&gt;\&#34;35\&#34; [label = \&#34;NN\&#34;] \n\&#34;21\&#34;-&gt;\&#34;36\&#34; [label = \&#34;NT\&#34;] \n\&#34;36\&#34;-&gt;\&#34;37\&#34; [label = \&#34;NN\&#34;] \n\&#34;3\&#34;-&gt;\&#34;38\&#34; [label = \&#34;TT\&#34;] \n\&#34;38\&#34;-&gt;\&#34;39\&#34; [label = \&#34;NN\&#34;] \n\&#34;7\&#34;-&gt;\&#34;40\&#34; [label = \&#34;TT\&#34;] \n\&#34;40\&#34;-&gt;\&#34;41\&#34; [label = \&#34;NN\&#34;] \n\&#34;11\&#34;-&gt;\&#34;42\&#34; [label = \&#34;TT\&#34;] \n\&#34;14\&#34;-&gt;\&#34;43\&#34; [label = \&#34;TT\&#34;] \n\&#34;43\&#34;-&gt;\&#34;44\&#34; [label = \&#34;NN\&#34;] \n\&#34;17\&#34;-&gt;\&#34;45\&#34; [label = \&#34;TT\&#34;] \n\&#34;21\&#34;-&gt;\&#34;46\&#34; [label = \&#34;TT\&#34;] \n\&#34;46\&#34;-&gt;\&#34;47\&#34; [label = \&#34;NN\&#34;] \n\&#34;4\&#34;-&gt;\&#34;48\&#34; [label = \&#34;NT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;49\&#34; [label = \&#34;NT\&#34;] \n\&#34;12\&#34;-&gt;\&#34;50\&#34; [label = \&#34;NT\&#34;] \n\&#34;15\&#34;-&gt;\&#34;51\&#34; [label = \&#34;NT\&#34;] \n\&#34;18\&#34;-&gt;\&#34;52\&#34; [label = \&#34;NT\&#34;] \n\&#34;22\&#34;-&gt;\&#34;53\&#34; [label = \&#34;NT\&#34;] \n\&#34;26\&#34;-&gt;\&#34;54\&#34; [label = \&#34;NT\&#34;] \n\&#34;28\&#34;-&gt;\&#34;55\&#34; [label = \&#34;NT\&#34;] \n\&#34;30\&#34;-&gt;\&#34;56\&#34; [label = \&#34;NT\&#34;] \n\&#34;32\&#34;-&gt;\&#34;57\&#34; [label = \&#34;NT\&#34;] \n\&#34;34\&#34;-&gt;\&#34;58\&#34; [label = \&#34;NT\&#34;] \n\&#34;36\&#34;-&gt;\&#34;59\&#34; [label = \&#34;NT\&#34;] \n\&#34;38\&#34;-&gt;\&#34;60\&#34; [label = \&#34;NT\&#34;] \n\&#34;40\&#34;-&gt;\&#34;61\&#34; [label = \&#34;NT\&#34;] \n\&#34;43\&#34;-&gt;\&#34;62\&#34; [label = \&#34;NT\&#34;] \n\&#34;46\&#34;-&gt;\&#34;63\&#34; [label = \&#34;NT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;64\&#34; [label = \&#34;TT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;65\&#34; [label = \&#34;TT\&#34;] \n\&#34;12\&#34;-&gt;\&#34;66\&#34; [label = \&#34;TT\&#34;] \n\&#34;15\&#34;-&gt;\&#34;67\&#34; [label = \&#34;TT\&#34;] \n\&#34;18\&#34;-&gt;\&#34;68\&#34; [label = \&#34;TT\&#34;] \n\&#34;22\&#34;-&gt;\&#34;69\&#34; [label = \&#34;TT\&#34;] \n\&#34;26\&#34;-&gt;\&#34;70\&#34; [label = \&#34;TT\&#34;] \n\&#34;28\&#34;-&gt;\&#34;71\&#34; [label = \&#34;TT\&#34;] \n\&#34;30\&#34;-&gt;\&#34;72\&#34; [label = \&#34;TT\&#34;] \n\&#34;32\&#34;-&gt;\&#34;73\&#34; [label = \&#34;TT\&#34;] \n\&#34;34\&#34;-&gt;\&#34;74\&#34; [label = \&#34;TT\&#34;] \n\&#34;36\&#34;-&gt;\&#34;75\&#34; [label = \&#34;TT\&#34;] \n\&#34;38\&#34;-&gt;\&#34;76\&#34; [label = \&#34;TT\&#34;] \n\&#34;40\&#34;-&gt;\&#34;77\&#34; [label = \&#34;TT\&#34;] \n\&#34;43\&#34;-&gt;\&#34;78\&#34; [label = \&#34;TT\&#34;] \n\&#34;46\&#34;-&gt;\&#34;79\&#34; [label = \&#34;TT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;The first thing to note about the graph above is that it is much more complex than the previous graphs.
The number of nodes in dose-paths increases faster than linearly as more cohorts are considered.
Consideration of this must be given when visualising dose-paths.&lt;/p&gt;
&lt;p&gt;Secondly, the visual method makes it simple to discern messages about future model behaviour.
For instance, we can easily see that dose 4, the darkest red node, is only reached in the first four cohorts if the first cohort sees no toxicity.&lt;/p&gt;
&lt;p&gt;In contrast to CRM, BOIN does have a stopping rule for excess toxicity built in.
We see that &lt;code&gt;TT&lt;/code&gt; in the first cohort is not enough to advocate stopping but that any further toxicity in the second cohort will be sufficient to warrant stopping.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;further-options&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Further options&lt;/h1&gt;
&lt;div id=&#34;non-uniform-cohorts&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Non-uniform cohorts&lt;/h2&gt;
&lt;p&gt;There is no reason that the cohort sizes should be uniform.
Specify whatever &lt;code&gt;cohort_sizes&lt;/code&gt; you like:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_boin(num_doses = 4, target = target) %&amp;gt;% 
  get_dose_paths(cohort_sizes = c(3, 1, 2))

graph_paths(paths, RColorBrewer_palette = &amp;#39;Blues&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-5&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-5&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;2\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#08519C\&#34;, fillcolor = \&#34;#6BAED6\&#34;] \n  \&#34;3\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#EFF3FF\&#34;, fillcolor = \&#34;#3182BD\&#34;] \n  \&#34;4\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#BDD7E7\&#34;, fillcolor = \&#34;#08519C\&#34;] \n  \&#34;5\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;7\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#08519C\&#34;, fillcolor = \&#34;#6BAED6\&#34;] \n  \&#34;8\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;9\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;11\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#6BAED6\&#34;, fillcolor = \&#34;#EFF3FF\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;13\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#08519C\&#34;, fillcolor = \&#34;#6BAED6\&#34;] \n  \&#34;14\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;16\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#6BAED6\&#34;, fillcolor = \&#34;#EFF3FF\&#34;] \n  \&#34;17\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#08519C\&#34;, fillcolor = \&#34;#6BAED6\&#34;] \n  \&#34;18\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;19\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;20\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;21\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;22\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#08519C\&#34;, fillcolor = \&#34;#6BAED6\&#34;] \n  \&#34;23\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;24\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#6BAED6\&#34;, fillcolor = \&#34;#EFF3FF\&#34;] \n  \&#34;25\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#3182BD\&#34;, fillcolor = \&#34;#BDD7E7\&#34;] \n  \&#34;26\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#6BAED6\&#34;, fillcolor = \&#34;#EFF3FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;N\&#34;] \n\&#34;3\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNT\&#34;] \n\&#34;5\&#34;-&gt;\&#34;6\&#34; [label = \&#34;N\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;NTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;N\&#34;] \n\&#34;9\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;11\&#34; [label = \&#34;TTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;12\&#34; [label = \&#34;T\&#34;] \n\&#34;12\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NN\&#34;] \n\&#34;5\&#34;-&gt;\&#34;14\&#34; [label = \&#34;T\&#34;] \n\&#34;14\&#34;-&gt;\&#34;15\&#34; [label = \&#34;NN\&#34;] \n\&#34;8\&#34;-&gt;\&#34;16\&#34; [label = \&#34;T\&#34;] \n\&#34;3\&#34;-&gt;\&#34;17\&#34; [label = \&#34;NT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;18\&#34; [label = \&#34;NT\&#34;] \n\&#34;9\&#34;-&gt;\&#34;19\&#34; [label = \&#34;NT\&#34;] \n\&#34;12\&#34;-&gt;\&#34;20\&#34; [label = \&#34;NT\&#34;] \n\&#34;14\&#34;-&gt;\&#34;21\&#34; [label = \&#34;NT\&#34;] \n\&#34;3\&#34;-&gt;\&#34;22\&#34; [label = \&#34;TT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;23\&#34; [label = \&#34;TT\&#34;] \n\&#34;9\&#34;-&gt;\&#34;24\&#34; [label = \&#34;TT\&#34;] \n\&#34;12\&#34;-&gt;\&#34;25\&#34; [label = \&#34;TT\&#34;] \n\&#34;14\&#34;-&gt;\&#34;26\&#34; [label = \&#34;TT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;You can even evaluate the dose advice after each patient using cohort sizes of 1:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_boin(num_doses = 4, target = target) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(1, 4))

graph_paths(paths, RColorBrewer_palette = &amp;#39;RdPu&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-6&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-6&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;2\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#7A0177\&#34;, fillcolor = \&#34;#F768A1\&#34;] \n  \&#34;3\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FEEBE2\&#34;, fillcolor = \&#34;#C51B8A\&#34;] \n  \&#34;4\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#FBB4B9\&#34;, fillcolor = \&#34;#7A0177\&#34;] \n  \&#34;5\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#FBB4B9\&#34;, fillcolor = \&#34;#7A0177\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;8\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;9\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;11\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#7A0177\&#34;, fillcolor = \&#34;#F768A1\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;14\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;16\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#7A0177\&#34;, fillcolor = \&#34;#F768A1\&#34;] \n  \&#34;17\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FEEBE2\&#34;, fillcolor = \&#34;#C51B8A\&#34;] \n  \&#34;18\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;19\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;20\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;21\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;22\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#F768A1\&#34;, fillcolor = \&#34;#FEEBE2\&#34;] \n  \&#34;23\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#FEEBE2\&#34;, fillcolor = \&#34;#C51B8A\&#34;] \n  \&#34;24\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;25\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;26\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#F768A1\&#34;, fillcolor = \&#34;#FEEBE2\&#34;] \n  \&#34;27\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n  \&#34;28\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#F768A1\&#34;, fillcolor = \&#34;#FEEBE2\&#34;] \n  \&#34;29\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#C51B8A\&#34;, fillcolor = \&#34;#FBB4B9\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;N\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;N\&#34;] \n\&#34;3\&#34;-&gt;\&#34;4\&#34; [label = \&#34;N\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;N\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;T\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;N\&#34;] \n\&#34;7\&#34;-&gt;\&#34;8\&#34; [label = \&#34;N\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;N\&#34;] \n\&#34;2\&#34;-&gt;\&#34;10\&#34; [label = \&#34;T\&#34;] \n\&#34;10\&#34;-&gt;\&#34;11\&#34; [label = \&#34;N\&#34;] \n\&#34;11\&#34;-&gt;\&#34;12\&#34; [label = \&#34;N\&#34;] \n\&#34;6\&#34;-&gt;\&#34;13\&#34; [label = \&#34;T\&#34;] \n\&#34;13\&#34;-&gt;\&#34;14\&#34; [label = \&#34;N\&#34;] \n\&#34;14\&#34;-&gt;\&#34;15\&#34; [label = \&#34;N\&#34;] \n\&#34;3\&#34;-&gt;\&#34;16\&#34; [label = \&#34;T\&#34;] \n\&#34;16\&#34;-&gt;\&#34;17\&#34; [label = \&#34;N\&#34;] \n\&#34;7\&#34;-&gt;\&#34;18\&#34; [label = \&#34;T\&#34;] \n\&#34;18\&#34;-&gt;\&#34;19\&#34; [label = \&#34;N\&#34;] \n\&#34;10\&#34;-&gt;\&#34;20\&#34; [label = \&#34;T\&#34;] \n\&#34;20\&#34;-&gt;\&#34;21\&#34; [label = \&#34;N\&#34;] \n\&#34;13\&#34;-&gt;\&#34;22\&#34; [label = \&#34;T\&#34;] \n\&#34;4\&#34;-&gt;\&#34;23\&#34; [label = \&#34;T\&#34;] \n\&#34;8\&#34;-&gt;\&#34;24\&#34; [label = \&#34;T\&#34;] \n\&#34;11\&#34;-&gt;\&#34;25\&#34; [label = \&#34;T\&#34;] \n\&#34;14\&#34;-&gt;\&#34;26\&#34; [label = \&#34;T\&#34;] \n\&#34;16\&#34;-&gt;\&#34;27\&#34; [label = \&#34;T\&#34;] \n\&#34;18\&#34;-&gt;\&#34;28\&#34; [label = \&#34;T\&#34;] \n\&#34;20\&#34;-&gt;\&#34;29\&#34; [label = \&#34;T\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;/div&gt;
&lt;div id=&#34;partially-completed-trials&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Partially completed trials&lt;/h2&gt;
&lt;p&gt;It is possible to calculate dose-paths from trials that are partially completed.
For instance, let us continue with our BOIN model and assume that we have seen outcomes &lt;code&gt;1NNN 2TNT&lt;/code&gt; so far in our trial.
Thus, we are reasonably sure that dose 1 is safe but wary that dose 2 might be too toxic.
However, these beliefs are tempered by the tiny sample size.
From this starting point, how might the next two cohorts of three proceed?
We just specify the previous outcomes using the &lt;code&gt;previous_outcomes&lt;/code&gt; parameter:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_boin(num_doses = 4, target = target) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(3, 2), previous_outcomes = &amp;#39;1NNN 2TNT&amp;#39;)

graph_paths(paths, viridis_palette = &amp;#39;viridis&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-7&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-7&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;2\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#21908CFF\&#34;] \n  \&#34;3\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;4\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#21908CFF\&#34;] \n  \&#34;5\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;8\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;9\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;11\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;14\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;16\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;17\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;18\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;19\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;20\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;21\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NNT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NNT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;15\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;16\&#34; [label = \&#34;NTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;17\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;18\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;19\&#34; [label = \&#34;TTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;20\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;21\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;Notice how this is different to the advice we get at the start of the trial (i.e. when omitting the &lt;code&gt;previous_outcomes&lt;/code&gt;):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_boin(num_doses = 4, target = target) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(3, 2))

graph_paths(paths, viridis_palette = &amp;#39;viridis&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-8&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-8&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;2\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#21908CFF\&#34;] \n  \&#34;3\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#440154FF\&#34;, fillcolor = \&#34;#5DC863FF\&#34;] \n  \&#34;4\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;5\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#FDE725FF\&#34;, fillcolor = \&#34;#21908CFF\&#34;] \n  \&#34;6\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;7\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;8\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;9\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;10\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;11\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;12\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;13\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;14\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;15\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#5DC863FF\&#34;, fillcolor = \&#34;#3B528BFF\&#34;] \n  \&#34;16\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n  \&#34;17\&#34; [label = \&#34;Stop\&#34;, fontcolor = \&#34;#21908CFF\&#34;, fillcolor = \&#34;#440154FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;TTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NNT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;15\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;16\&#34; [label = \&#34;TTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;17\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;This is a feature of model-based methods like CRM and BOIN - they use all information at all doses when making dose decisions.
They are not memoryless like the 3+3.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;next-dose&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Next dose&lt;/h2&gt;
&lt;p&gt;The dose at which dose-paths commence is inferred from the model.
It can be specified manually, however:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_three_plus_three(num_doses = 5, allow_deescalate = TRUE) %&amp;gt;% 
  get_dose_paths(cohort_sizes = c(3, 3), next_dose = 3)

graph_paths(paths, viridis_palette = &amp;#39;plasma&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-9&#34; style=&#34;width:672px;height:672px;&#34; class=&#34;grViz html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-9&#34;&gt;{&#34;x&#34;:{&#34;diagram&#34;:&#34;digraph {\n\ngraph [layout = \&#34;neato\&#34;,\n       outputorder = \&#34;edgesfirst\&#34;,\n       bgcolor = \&#34;white\&#34;]\n\nnode [fontname = \&#34;Helvetica\&#34;,\n      fontsize = \&#34;10\&#34;,\n      shape = \&#34;circle\&#34;,\n      fixedsize = \&#34;true\&#34;,\n      width = \&#34;0.5\&#34;,\n      style = \&#34;filled\&#34;,\n      fillcolor = \&#34;aliceblue\&#34;,\n      color = \&#34;gray70\&#34;,\n      fontcolor = \&#34;gray50\&#34;]\n\nedge [fontname = \&#34;Helvetica\&#34;,\n     fontsize = \&#34;8\&#34;,\n     len = \&#34;1.5\&#34;,\n     color = \&#34;gray80\&#34;,\n     arrowsize = \&#34;0.5\&#34;]\n\n  \&#34;1\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#0D0887FF\&#34;, fillcolor = \&#34;#E16462FF\&#34;] \n  \&#34;2\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#6A00A8FF\&#34;, fillcolor = \&#34;#FCA636FF\&#34;] \n  \&#34;3\&#34; [label = \&#34;5\&#34;, fontcolor = \&#34;#B12A90FF\&#34;, fillcolor = \&#34;#F0F921FF\&#34;] \n  \&#34;4\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#0D0887FF\&#34;, fillcolor = \&#34;#E16462FF\&#34;] \n  \&#34;5\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#6A00A8FF\&#34;, fillcolor = \&#34;#FCA636FF\&#34;] \n  \&#34;6\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;7\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;8\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;9\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;10\&#34; [label = \&#34;4\&#34;, fontcolor = \&#34;#6A00A8FF\&#34;, fillcolor = \&#34;#FCA636FF\&#34;] \n  \&#34;11\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;12\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;13\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;14\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#0D0887FF\&#34;, fillcolor = \&#34;#E16462FF\&#34;] \n  \&#34;15\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;16\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA636FF\&#34;, fillcolor = \&#34;#6A00A8FF\&#34;] \n  \&#34;17\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA636FF\&#34;, fillcolor = \&#34;#6A00A8FF\&#34;] \n  \&#34;18\&#34; [label = \&#34;3\&#34;, fontcolor = \&#34;#0D0887FF\&#34;, fillcolor = \&#34;#E16462FF\&#34;] \n  \&#34;19\&#34; [label = \&#34;2\&#34;, fontcolor = \&#34;#F0F921FF\&#34;, fillcolor = \&#34;#B12A90FF\&#34;] \n  \&#34;20\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA636FF\&#34;, fillcolor = \&#34;#6A00A8FF\&#34;] \n  \&#34;21\&#34; [label = \&#34;1\&#34;, fontcolor = \&#34;#FCA636FF\&#34;, fillcolor = \&#34;#6A00A8FF\&#34;] \n\&#34;1\&#34;-&gt;\&#34;2\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;3\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;4\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;5\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;6\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;7\&#34; [label = \&#34;NNN\&#34;] \n\&#34;1\&#34;-&gt;\&#34;8\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;9\&#34; [label = \&#34;NNN\&#34;] \n\&#34;2\&#34;-&gt;\&#34;10\&#34; [label = \&#34;NNT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;11\&#34; [label = \&#34;NNT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;12\&#34; [label = \&#34;NNT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;13\&#34; [label = \&#34;NNT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;14\&#34; [label = \&#34;NTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;15\&#34; [label = \&#34;NTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;16\&#34; [label = \&#34;NTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;17\&#34; [label = \&#34;NTT\&#34;] \n\&#34;2\&#34;-&gt;\&#34;18\&#34; [label = \&#34;TTT\&#34;] \n\&#34;4\&#34;-&gt;\&#34;19\&#34; [label = \&#34;TTT\&#34;] \n\&#34;6\&#34;-&gt;\&#34;20\&#34; [label = \&#34;TTT\&#34;] \n\&#34;8\&#34;-&gt;\&#34;21\&#34; [label = \&#34;TTT\&#34;] \n}&#34;,&#34;config&#34;:{&#34;engine&#34;:&#34;dot&#34;,&#34;options&#34;:null}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;p&gt;A 3+3 trial with de-escalation enabled will de-escalate through the doses when toxicity is seen, as expected.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;crystallised-dose-paths&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Crystallised dose-paths&lt;/h1&gt;
&lt;p&gt;Calculating dose-paths is useful for visually examining the conditions under which a dose-finding design would escalate or de-escalate or stop.
However, that is only part of the story.
When we marry dose-paths with assumed true event probabilities, we can calculate exact operating characteristics of a design.
We refer to this as &lt;em&gt;crystallising&lt;/em&gt; dose paths because the likelihood of each path has been calculated precisely according to an assumed truth.&lt;/p&gt;
&lt;p&gt;For instance, we can calculate dose-paths for the first four cohorts of three patients using the CRM with stopping design that we specified previously:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skeleton &amp;lt;- c(0.05, 0.1, 0.25, 0.4, 0.6)
target &amp;lt;- 0.25

paths &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;%
  stop_when_too_toxic(dose = 1, tox_threshold = 0.35, confidence = 0.9) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(3, 4))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## You have requested 341 model evaluations. Be patient.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can then crystallise the paths using toxicity probabilities that exactly match the beliefs in our skeleton:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;true_prob_tox &amp;lt;- skeleton

x &amp;lt;- paths %&amp;gt;% calculate_probabilities(true_prob_tox = true_prob_tox)
x&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Number of nodes: 213 
## Number of terminal nodes: 160 
## 
## Number of doses: 5 
## 
## True probability of toxicity:
##    1    2    3    4    5 
## 0.05 0.10 0.25 0.40 0.60 
## 
## Probability of recommendation:
##   NoDose        1        2        3        4        5 
## 0.000127 0.019866 0.227135 0.451791 0.273014 0.028066 
## 
## Probability of continuance:
## [1] 1
## 
## Probability of administration:
##      1      2      3      4      5 
## 0.3172 0.1602 0.1867 0.2734 0.0626 
## 
## Expected sample size:
## [1] 11.99887
## 
## Expected total toxicities:
## [1] 2.705489&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We see that in this scenario, the probability of a path stopping and advocating no dose within the first four cohorts is very close to zero.
In contrast, when the toxicity probabilities are much greater than anticipated:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;true_prob_tox &amp;lt;- c(0.45, 0.6, 0.68, 0.75, 0.81)

x &amp;lt;- paths %&amp;gt;% calculate_probabilities(true_prob_tox = true_prob_tox)
x&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Number of nodes: 213 
## Number of terminal nodes: 160 
## 
## Number of doses: 5 
## 
## True probability of toxicity:
##    1    2    3    4    5 
## 0.45 0.60 0.68 0.75 0.81 
## 
## Probability of recommendation:
##    NoDose         1         2         3         4         5 
## 0.3027462 0.6407708 0.0502073 0.0055527 0.0006931 0.0000299 
## 
## Probability of continuance:
## [1] 0.697
## 
## Probability of administration:
##        1        2        3        4        5 
## 0.895800 0.052921 0.008539 0.042028 0.000711 
## 
## Expected sample size:
## [1] 10.73269
## 
## Expected total toxicities:
## [1] 5.102913&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;the probability of selecting no dose within these first four cohorts is over 30%.
The information labelled &lt;code&gt;Probability of continuance:&lt;/code&gt; shows the aggregate probability of paths that are continuing to advocate experimentation at doses, i.e. those paths that do not advocate stopping.&lt;/p&gt;
&lt;p&gt;We see above that the probability of continuance is 1 minus the probability of selecting no dose.
However, this need not necessarily be the case because paths can advocate stopping &lt;em&gt;and recommend a dose&lt;/em&gt;.
They might do so once it is felt that a suitable dose has been identified.
To make this point, let us imagine that we add a rule to our above design that allows stopping once there are 9 patients allocated to the recommended dose.
We can think of this as stopping for consensus.
Respecifying our model and recalculating dose-paths, we have:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;%
  stop_when_too_toxic(dose = 1, tox_threshold = 0.35, confidence = 0.9) %&amp;gt;% 
  stop_when_n_at_dose(dose = &amp;#39;recommended&amp;#39;, n = 9) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(3, 4))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## You have requested 341 model evaluations. Be patient.&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x &amp;lt;- paths %&amp;gt;% calculate_probabilities(true_prob_tox = true_prob_tox)
x&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Number of nodes: 141 
## Number of terminal nodes: 106 
## 
## Number of doses: 5 
## 
## True probability of toxicity:
##    1    2    3    4    5 
## 0.45 0.60 0.68 0.75 0.81 
## 
## Probability of recommendation:
##    NoDose         1         2         3         4         5 
## 0.2103223 0.7393498 0.0440522 0.0055527 0.0006931 0.0000299 
## 
## Probability of continuance:
## [1] 0.137
## 
## Probability of administration:
##        1        2        3        4        5 
## 0.895800 0.052921 0.008539 0.042028 0.000711 
## 
## Expected sample size:
## [1] 9.064864
## 
## Expected total toxicities:
## [1] 4.352391&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We see that this has reduced our probability of stopping for excess toxicity and inflated our chances of recommending dose 1.
Notably, the probability of continuance is now roughly 14%, suggesting that most paths have advocated stopping by now, either for toxicity or concensus.&lt;/p&gt;
&lt;p&gt;If we do not like that performance, we can make the consensus stopping rule more demanding by requesting 12 at the recommended dose to advocate stopping:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;paths &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;%
  stop_when_too_toxic(dose = 1, tox_threshold = 0.35, confidence = 0.9) %&amp;gt;% 
  stop_when_n_at_dose(dose = &amp;#39;recommended&amp;#39;, n = 12) %&amp;gt;% 
  get_dose_paths(cohort_sizes = rep(3, 4))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## You have requested 341 model evaluations. Be patient.&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;x &amp;lt;- paths %&amp;gt;% calculate_probabilities(true_prob_tox = true_prob_tox)
x&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Number of nodes: 213 
## Number of terminal nodes: 160 
## 
## Number of doses: 5 
## 
## True probability of toxicity:
##    1    2    3    4    5 
## 0.45 0.60 0.68 0.75 0.81 
## 
## Probability of recommendation:
##    NoDose         1         2         3         4         5 
## 0.3027462 0.6407708 0.0502073 0.0055527 0.0006931 0.0000299 
## 
## Probability of continuance:
## [1] 0.24
## 
## Probability of administration:
##        1        2        3        4        5 
## 0.895800 0.052921 0.008539 0.042028 0.000711 
## 
## Expected sample size:
## [1] 10.73269
## 
## Expected total toxicities:
## [1] 5.102913&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As usual, deriving an acceptable design is an iterative process.
The tools in &lt;code&gt;escalation&lt;/code&gt; make it easier to arrive at a design that performs how you want.&lt;/p&gt;
&lt;p&gt;Combining dose-paths with true event probabilities allows probabilistic inference on dose-finding designs.
This is a novel extension to the use advocated by &lt;span class=&#34;citation&#34;&gt;Yap et al. (2017)&lt;/span&gt; and &lt;span class=&#34;citation&#34;&gt;Brock et al. (2017)&lt;/span&gt;.
The use of exact operating characteristics has been implemented for the 3+3 design in the &lt;code&gt;bcrm&lt;/code&gt; package &lt;span class=&#34;citation&#34;&gt;(Sweeting and Wheeler 2019)&lt;/span&gt;.
We generalise the method here.&lt;/p&gt;
&lt;div id=&#34;dose-paths-vs-simulation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Dose-paths vs simulation&lt;/h2&gt;
&lt;p&gt;We saw above that probabilistic inference was possible with dose-paths.
Researchers have typically used simulation to achieve this task.
&lt;code&gt;escalation&lt;/code&gt; supports simulation as well through the &lt;code&gt;simulate_trials&lt;/code&gt; function.
However, this does raise the question, when should you use each method, and what are their relative merits?&lt;/p&gt;
&lt;p&gt;The answer to the first question comes down to the expected number of model fits required.
Fitting dose-finding models takes computer time.
In dose-paths, the model is fit once at each node.
We have seen examples above of how the number and size of cohorts affects the number of nodes in dose-paths.
In fact, &lt;code&gt;escalation&lt;/code&gt; provides a function to calculate the number of nodes.&lt;/p&gt;
&lt;p&gt;In a phase 1 dose-finding trial, each patient experiences exactly one of two outcomes: &lt;code&gt;T&lt;/code&gt; or &lt;code&gt;N&lt;/code&gt;.
Let us calculate how many nodes there are in a graph of dose-paths using five cohorts of three patients.
We run:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;num_dose_path_nodes(num_patient_outcomes = 2, cohort_sizes = rep(3, 5))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1]    1    4   16   64  256 1024&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;num_patient_outcomes = 2&lt;/code&gt; parameter reflects that patients may experience &lt;code&gt;T&lt;/code&gt; or &lt;code&gt;N&lt;/code&gt;.
The returned vector of integers is the number of nodes at each depth.
There is one starting node.
That node is connected to four children via outcomes &lt;code&gt;NNN&lt;/code&gt;, &lt;code&gt;NNT&lt;/code&gt;, &lt;code&gt;NTT&lt;/code&gt;, and &lt;code&gt;TTT&lt;/code&gt;.
The number of nodes at greater depths proceeds multiplicatively thereafter.
The total number of nodes is:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;num_dose_path_nodes(num_patient_outcomes = 2, cohort_sizes = rep(3, 5)) %&amp;gt;% 
  sum&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 1365&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Thus it requires exactly 1,365 model fits to calculate the exact operating characteristics in this &lt;span class=&#34;math inline&#34;&gt;\(n = 5 \times 3 = 15\)&lt;/span&gt; patient scenario.
To compare this to simulations, consider that each simulated trial iteration will fit the model up to five times, once at the end of each cohort.
The total number of model fits in a simulation study is bounded by this number multiplied by the number of simulated iterations.
Generally simulation studies use thousands of replicates, so it is easy to see that exact inference via crystallised dose-paths will be much less computaionally burdensome, and therefore faster here.&lt;/p&gt;
&lt;p&gt;In contrast, now consider a trial of eight cohorts of three.
The total number of model fits to enumerate the complete graph of dose-paths is&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;num_dose_path_nodes(num_patient_outcomes = 2, cohort_sizes = rep(3, 8)) %&amp;gt;% 
  sum&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 87381&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ten thousand simulated iterations of 8 cohorts each would only require up to 80,000 model fits.
Thus, a reasonably accurate simulation study would be expected to be faster here.&lt;/p&gt;
&lt;p&gt;However, speed is not the only concern: there is also precision to consider.
Simulations have the disadvantage of suffering from Monte Carlo error, that is the uncertainty about the estimated statistics arising from the use of a finite number of simulated iterations.
In contrast, exact inference via dose-paths has the great advantage of being exact.
That is, there is no uncertainty in the calculated probabilities.
(Note: there is still uncertainty about which path will be taken because that is determined by random patient outcomes).
Thus, there are scenarios when dose-paths may still be preferable to simulations, even when they are expected to take longer.&lt;/p&gt;
&lt;p&gt;It is likely that in practice, simulation is often used when dose-paths would be a better option.
If true, that would likely be linked to provision of software that performs the two methods.
&lt;code&gt;escalation&lt;/code&gt; plugs that gap.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level1 unnumbered&#34;&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-Brock2017a&#34;&gt;
&lt;p&gt;Brock, Kristian, Lucinda Billingham, Mhairi Copland, Shamyla Siddique, Mirjana Sirovica, and Christina Yap. 2017. “Implementing the EffTox Dose-Finding Design in the Matchpoint Trial.” &lt;em&gt;BMC Medical Research Methodology&lt;/em&gt; 17 (1): 112. &lt;a href=&#34;https://doi.org/10.1186/s12874-017-0381-x&#34;&gt;https://doi.org/10.1186/s12874-017-0381-x&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-dfcrm&#34;&gt;
&lt;p&gt;Cheung, Ken. 2013. &lt;em&gt;Dfcrm: Dose-Finding by the Continual Reassessment Method&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=dfcrm&#34;&gt;https://CRAN.R-project.org/package=dfcrm&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-liu_bayesian_2015&#34;&gt;
&lt;p&gt;Liu, Suyu, and Ying Yuan. 2015. “Bayesian Optimal Interval Designs for Phase I Clinical Trials.” &lt;em&gt;Journal of the Royal Statistical Society: Series C (Applied Statistics)&lt;/em&gt; 64 (3): 507–23. &lt;a href=&#34;https://doi.org/10.1111/rssc.12089&#34;&gt;https://doi.org/10.1111/rssc.12089&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-OQuigley1990&#34;&gt;
&lt;p&gt;O’Quigley, J, M Pepe, and L Fisher. 1990. “Continual Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.” &lt;em&gt;Biometrics&lt;/em&gt; 46 (1): 33–48. &lt;a href=&#34;https://doi.org/10.2307/2531628&#34;&gt;https://doi.org/10.2307/2531628&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-bcrm&#34;&gt;
&lt;p&gt;Sweeting, Michael, and Graham Wheeler. 2019. &lt;em&gt;Bcrm: Bayesian Continual Reassessment Method for Phase I Dose-Escalation Trials&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=bcrm&#34;&gt;https://CRAN.R-project.org/package=bcrm&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-wheelerHowDesignDosefinding2019&#34;&gt;
&lt;p&gt;Wheeler, Graham M., Adrian P. Mander, Alun Bedding, Kristian Brock, Victoria Cornelius, Andrew P. Grieve, Thomas Jaki, et al. 2019. “How to Design a Dose-Finding Study Using the Continual Reassessment Method.” &lt;em&gt;BMC Medical Research Methodology&lt;/em&gt; 19 (1). &lt;a href=&#34;https://doi.org/10.1186/s12874-018-0638-z&#34;&gt;https://doi.org/10.1186/s12874-018-0638-z&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Yap2017&#34;&gt;
&lt;p&gt;Yap, Christina, Lucinda J. Billingham, Ying Kuen Cheung, Charlie Craddock, and John O’Quigley. 2017. “Dose Transition Pathways: The Missing Link Between Complex Dose-Finding Designs and Simple Decision-Making.” &lt;em&gt;Clinical Cancer Research&lt;/em&gt; 23 (24): 7440–7. &lt;a href=&#34;https://doi.org/10.1158/1078-0432.CCR-17-0582&#34;&gt;https://doi.org/10.1158/1078-0432.CCR-17-0582&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-BOIN&#34;&gt;
&lt;p&gt;Yuan, Ying, and Suyu Liu. 2018. &lt;em&gt;BOIN: Bayesian Optimal Interval (Boin) Design for Single-Agent and Drug- Combination Phase I Clinical Trials&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=BOIN&#34;&gt;https://CRAN.R-project.org/package=BOIN&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>PePS2 Results</title>
      <link>https://www.kristianbrock.com/post/peps2-results/</link>
      <pubDate>Mon, 06 Apr 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/peps2-results/</guid>
      <description>


&lt;div id=&#34;summary&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Summary&lt;/h1&gt;
&lt;p&gt;PePS2 is a phase II clinical trial of pembrolizumab in non-small-cell lung cancer (NSCLC) patients with a performance status of 2.
Trial results were recently published in Lancet Respiratory Medicine &lt;span class=&#34;citation&#34;&gt;(Middleton et al. 2020)&lt;/span&gt;.
Previous trials in the KEYNOTE series &lt;span class=&#34;citation&#34;&gt;(Garon et al. 2015; Herbst et al. 2016)&lt;/span&gt; had showed that pembrolizumab was efficacious in NSCLC patients.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;the-gap-in-the-evidence&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;The gap in the evidence&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Performance_status#ECOG/WHO/Zubrod_score&#34;&gt;Performance status&lt;/a&gt; (PS) is a variable defined by the Eastern Cooperative Oncology Group to reflect cancer patients’ general well-being and activities of daily life.
It is an ordered variable with five levels reflecting greater levels of disability:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0 – patients are asymptomatic;&lt;/li&gt;
&lt;li&gt;1 – patients are symptomatic but completely ambulatory;&lt;/li&gt;
&lt;li&gt;2 – patients are symptomatic, spending up to 50% of day time in bed;&lt;/li&gt;
&lt;li&gt;3 – patients are symptomatic, spending at least 50% of day time in bed;&lt;/li&gt;
&lt;li&gt;4 – patients are bedbound.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We will say that a patient with a peformance status of 2 is &lt;em&gt;PS2&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The KEYNOTE-001 trial &lt;span class=&#34;citation&#34;&gt;(Garon et al. 2015)&lt;/span&gt; showed that pembrolizumab was efficacious in NSCLC patients.
The subsequent KEYNOTE-010 trial &lt;span class=&#34;citation&#34;&gt;(Herbst et al. 2016)&lt;/span&gt; showed that pembrolizumab was superior to docetaxel chemotherapy.
However, it is doubtful that a PS2 patient would be strong enough to tolerate chemotherapy.
Hence, to maintain equipoise in KEYNOTE-010, the trialists restricted randomisation to PS0 and PS1 patients.
That trial was successful and pembrolizumab was licenced in NSCLC.
However, as is typical, the treatment was licenced in the patient population that had been investigated in the trial.
This covered just the PS0 and PS1 patients and crucially excluded PS2 patients.
The KEYNOTE trials had showed that pembrolizumab was tolerable, particularly compared to the harsh chemotherapy alternatives.
It is precisely in the PS2 population where a relatively tolerable but effective treatment was sorely needed.
However, by virtue of their probable unsuitablility to chemotherapy, PS2 patients had been excluded from a promising new treatment.&lt;/p&gt;
&lt;p&gt;The PePS2 trial sought to address this gap in the evidence.&lt;/p&gt;
&lt;div id=&#34;stratification&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Stratification&lt;/h2&gt;
&lt;p&gt;In the KEYNOTE-001 trial, &lt;span class=&#34;citation&#34;&gt;Garon et al. (2015)&lt;/span&gt; had introduced the programmed death ligand 1 tumour proportion score biomarker (PD-L1 TPS, or simply TPS), being the percentage of cells in a tumour biopsy that expressed PD-L1.
Pembrolizumab is a PD-L1 blockade drug so it was reasonably hypothesised that the treatment would work best in those patients whose tumours expressed lots of PD-L1.
The KEYNOTE-001 showed this to be precisely the case.&lt;/p&gt;
&lt;p&gt;KEYNOTE-001 also showed that first-line patients (those patients who had received no previous anti-cancer therapy) achieved outcomes that appeared to be slightly different to patients receiving pembrolizumab as a subsequent-line therapy.&lt;/p&gt;
&lt;p&gt;In PePS2, we sought to evaluate the effects of pembrolizumab on co-primary efficacy and toxicity outcomes whilst stratifying the analysis for these baseline covariates.
I developed a statistical design for this purpose, described &lt;a href=&#34;https://www.kristianbrock.com/publication/peps2-design/&#34;&gt;here&lt;/a&gt; &lt;span class=&#34;citation&#34;&gt;(Brock et al. 2019)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;results&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Results&lt;/h2&gt;
&lt;p&gt;On 19-March-2020, the &lt;a href=&#34;https://www.thelancet.com/journals/lanres/article/PIIS2213-2600(20)30033-3/fulltext&#34;&gt;results were published&lt;/a&gt; in Lancet Respiratory Medicine.
&lt;span class=&#34;citation&#34;&gt;Alessi and Awad (2020)&lt;/span&gt; provided an accompanying commentary of the data in that same journal.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;more&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;More&lt;/h2&gt;
&lt;p&gt;Information on the PePS2 project is collated on the &lt;a href=&#34;https://www.kristianbrock.com/project/peps2/&#34;&gt;project page&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-alessi_immunotherapy_2020&#34;&gt;
&lt;p&gt;Alessi, Joao V, and Mark M Awad. 2020. “Immunotherapy in Lung Cancer: Effective for Patients with Poor Performance Status?” &lt;em&gt;The Lancet Respiratory Medicine&lt;/em&gt;, March, S2213260020301077. &lt;a href=&#34;https://doi.org/10.1016/S2213-2600(20)30107-7&#34;&gt;https://doi.org/10.1016/S2213-2600(20)30107-7&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-brock_phase_2019&#34;&gt;
&lt;p&gt;Brock, Kristian, Lucinda Billingham, Christina Yap, and Gary Middleton. 2019. “A Phase II Clinical Trial Design for Associated Co-Primary Efficacy and Toxicity Outcomes with Baseline Covariates.” In &lt;em&gt;Bayesian Statistics and New Generations&lt;/em&gt;, edited by Raffaele Argiento, Daniele Durante, and Sara Wade, 125–33. Springer Proceedings in Mathematics &amp;amp; Statistics. Cham: Springer International Publishing. &lt;a href=&#34;https://doi.org/10.1007/978-3-030-30611-3_13&#34;&gt;https://doi.org/10.1007/978-3-030-30611-3_13&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Garon2015&#34;&gt;
&lt;p&gt;Garon, Edward B, Naiyer a Rizvi, Rina Hui, Natasha Leighl, Ani S Balmanoukian, Joseph Paul Eder, Amita Patnaik, et al. 2015. “Pembrolizumab for the Treatment of Non-Small-Cell Lung Cancer.” &lt;em&gt;The New England Journal of Medicine&lt;/em&gt; 372 (21): 2018–28. &lt;a href=&#34;https://doi.org/10.1056/NEJMoa1501824&#34;&gt;https://doi.org/10.1056/NEJMoa1501824&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Herbst2016&#34;&gt;
&lt;p&gt;Herbst, Roy S., Paul Baas, Dong Wan Kim, Enriqueta Felip, José L. Pérez-Gracia, Ji Youn Han, Julian Molina, et al. 2016. “Pembrolizumab Versus Docetaxel for Previously Treated, PD-L1-Positive, Advanced Non-Small-Cell Lung Cancer (KEYNOTE-010): A Randomised Controlled Trial.” &lt;em&gt;The Lancet&lt;/em&gt; 387 (10027): 1540–50. &lt;a href=&#34;https://doi.org/10.1016/S0140-6736(15)01281-7&#34;&gt;https://doi.org/10.1016/S0140-6736(15)01281-7&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-middleton_pembrolizumab_2020&#34;&gt;
&lt;p&gt;Middleton, Gary, Kristian Brock, Joshua Savage, Rhys Mant, Yvonne Summers, John Connibear, Riyaz Shah, et al. 2020. “Pembrolizumab in Patients with Non-Small-Cell Lung Cancer of Performance Status 2 (PePS2): A Single Arm, Phase 2 Trial.” &lt;em&gt;The Lancet Respiratory Medicine&lt;/em&gt; 0 (0). &lt;a href=&#34;https://doi.org/10.1016/S2213-2600(20)30033-3&#34;&gt;https://doi.org/10.1016/S2213-2600(20)30033-3&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Introducing escalation</title>
      <link>https://www.kristianbrock.com/post/introducing-escalation/</link>
      <pubDate>Thu, 13 Feb 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/introducing-escalation/</guid>
      <description>


&lt;div id=&#34;escalation&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;escalation &lt;img src=&#34;https://github.com/brockk/escalation/raw/master/man/figures/logo.png&#34; align=&#34;right&#34; height=140/&gt;&lt;/h1&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/brockk/escalation&#34;&gt;&lt;strong&gt;escalation&lt;/strong&gt;&lt;/a&gt; is a new R package that takes existing dose-finding models and gives them a common interface.
To use the language of &lt;a href=&#34;https://www.tidyverse.org/&#34;&gt;tidyverse&lt;/a&gt; R, &lt;strong&gt;escalation&lt;/strong&gt; provides a grammar for dose-finding by breaking the dose-finding process into chunks.
What model should I use?
How should I select dose during the trial?
How will I know when to stop?
Which restrictions should I place on escalation and de-escalation?
You can create the dose-finding design you want in &lt;strong&gt;escalation&lt;/strong&gt; by combining elements that perform all of these tasks.
This might all sound a little obtuse.
Some examples will make it clear.&lt;/p&gt;
&lt;div id=&#34;examples&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Examples&lt;/h2&gt;
&lt;div id=&#34;crm&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;CRM&lt;/h4&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34;&gt;O’Quigley, Pepe, and Fisher (1990)&lt;/span&gt; introduced the classic continual reassessment method (CRM) and it has been implemented in many software packages since.
One of the most popular R implementations is the &lt;a href=&#34;https://CRAN.R-project.org/package=dfcrm&#34;&gt;dfcrm&lt;/a&gt; package by &lt;span class=&#34;citation&#34;&gt;Cheung (2013)&lt;/span&gt;.
Let’s fit a model using dfcrm.&lt;/p&gt;
&lt;p&gt;The very least information we need to provide is a dose-toxicity skeleton, and our target toxicity level:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skeleton &amp;lt;- c(0.05, 0.1, 0.25, 0.4, 0.6)
target &amp;lt;- 0.25&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We use these to create a model-fitting object:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(escalation)
model &amp;lt;- get_dfcrm(skeleton = skeleton, target = target)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The model can then be fit to outcomes.
The escalation package uses the outcome syntax introduced for phase I trials in &lt;span class=&#34;citation&#34;&gt;Brock (2019)&lt;/span&gt; and for seamless phase I/II trials in &lt;span class=&#34;citation&#34;&gt;Brock et al. (2017)&lt;/span&gt;.
Let’s assume we have treated 3 patients at dose-level 2 and none of them experienced toxicity.
We represent this using the outcome string &lt;code&gt;2NNN&lt;/code&gt;.
Fitting the model to the set of outcomes invokes the dose-selection algorithm:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and the fit object will tell you the dose recommended by the CRM model to be administered next:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 4&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The model advocates skipping straight from dose 2 to dose 4.
Clinicians are unlikely to feel comfortable with this.
We can respecify the model to expressly not skip doses in escalation:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;% 
  dont_skip_doses(when_escalating = TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We have taken the original dfcrm model and added an extra module to prevent skipping doses in escalation.
Refitting the new model to the same outcomes gives:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We see that the ensemble now decides to select dose 3.
We can ask the trial design whether it wants to keep recruting patients:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] TRUE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Naturally it wants to continue because &lt;code&gt;dfcrm&lt;/code&gt; does not implement any stopping rules.
However, we can easily add some.
Let us say that we want to stop once the model has evaluated 18 patients, or at least 9 at the dose being recommended, whichever occurs first.
We specify this model by adding more behaviours:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- get_dfcrm(skeleton = skeleton, target = target) %&amp;gt;% 
  dont_skip_doses(when_escalating = TRUE) %&amp;gt;% 
  stop_at_n(n = 18) %&amp;gt;% 
  stop_when_n_at_dose(dose = &amp;#39;recommended&amp;#39;, n = 9)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s fit this model to some more patients to see how this trial plays out:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN 3TTN&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] TRUE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;After seeing two-in-three patients in the second cohort experience toxicity at dose 3, the design understandably wants to de-escalate.
Let’s do that:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN 3TTN 2TNN&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] TRUE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The third cohort yielded one-in-three tox at dose 2.
The design wants to continue at dose 2 so let’s do that:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN 3TTN 2TNN 2NNT&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] FALSE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice that the call to continue() now returns FALSE.
The design wants to stop now and recommend dose 2.
It does this because it has seen 9 patients at the recommended dose.
We can see the number of patients treated at each of the five doses under investigation:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% n_at_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0 9 3 0 0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Our stopping criteria have been met.
We can verify that dose 2 is indeed the dose with posterior expected toxicity rate closest to our target of 25%:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% mean_prob_tox()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.1845713 0.2728713 0.4575229 0.5964102 0.7496662&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;boin&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;BOIN&lt;/h4&gt;
&lt;p&gt;&lt;code&gt;escalate&lt;/code&gt; also implements the BOIN dose-finding design by &lt;span class=&#34;citation&#34;&gt;Liu and Yuan (2015)&lt;/span&gt; via the &lt;a href=&#34;https://CRAN.R-project.org/package=BOIN&#34;&gt;&lt;code&gt;BOIN&lt;/code&gt;&lt;/a&gt; R-package &lt;span class=&#34;citation&#34;&gt;(Yuan and Liu 2018)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;In contrast to CRM, BOIN does not require a dose-toxicity skeleton.
In its simplest case, it requires merely the number of doses under investigation and our target toxicity level:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;target &amp;lt;- 0.25
model &amp;lt;- get_boin(num_doses = 5, target = target)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As before, we can fit the model to some observed outcomes:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 3&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] TRUE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The BOIN dose selector natively implements stopping rules, as described by Liu &amp;amp; Yuan.
For instance, if the bottom dose is too toxic, the design will advise the trial halts:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NTN 1TTT&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] NA&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] FALSE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nevertheless, as with the CRM examples above, our BOIN selector can be adorned with various behaviours to tailor stopping and skipping.
In fact, we can add the exact same behaviours as before because all &lt;code&gt;escalation&lt;/code&gt; objects support exactly the same interface.
This makes the package completely modular.
We are building the design we want from pieces of Lego:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- get_boin(num_doses = 5, target = target) %&amp;gt;% 
  dont_skip_doses(when_escalating = TRUE) %&amp;gt;% 
  stop_at_n(n = 18) %&amp;gt;% 
  stop_when_n_at_dose(dose = &amp;#39;recommended&amp;#39;, n = 9)

fit &amp;lt;- model %&amp;gt;% fit(&amp;#39;2NNN 3TTN 2TNN 2NNT&amp;#39;)
fit %&amp;gt;% recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% continue()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] FALSE&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fit %&amp;gt;% mean_prob_tox()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1]   NA 0.23 0.66   NA   NA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice that the posterior toxicity estimate is similar to the CRM model at dose 2, but ultimately different because the two approaches use different model forms.
BOIN does not estimate the tox rate at doses that have not been administered.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;initial-escalation-plans&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Initial escalation plans&lt;/h4&gt;
&lt;p&gt;Another dose-selection mechanism supported by escalation is the concept of an &lt;em&gt;initial escalation plan&lt;/em&gt;.
These can be used at the start of a trial to show how escalation should proceed initially.
As soon as the realised outcomes diverge from the prespecified path, or the path reaches the end, a secondary model takes over.&lt;/p&gt;
&lt;p&gt;For instance, let us assume we would like to treat one patient per dose so long as no toxicity is seen, in order to facilitate fast escalation.
When toxicity is seen, or dose five is reached, we would like to hand control to a CRM model.
We can write:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- follow_path(&amp;#39;1N 2N 3N 4N 5N&amp;#39;) %&amp;gt;% 
  get_dfcrm(skeleton = skeleton, target = target)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So long as the idealised path is realised, it continues:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model %&amp;gt;% 
  fit(&amp;#39;1N&amp;#39;) %&amp;gt;% 
  recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model %&amp;gt;% 
  fit(&amp;#39;1N 2N&amp;#39;) %&amp;gt;% 
  recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But if the path is deviated from, the secondary model takes over:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model %&amp;gt;% 
  fit(&amp;#39;1N 2N 3T&amp;#39;) %&amp;gt;% 
  recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Also, when the initial path is completed, the secondary model continues:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model %&amp;gt;% 
  fit(&amp;#39;1N 2N 3N 4N 5N&amp;#39;) %&amp;gt;% 
  recommended_dose()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 5&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;summary&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;The &lt;strong&gt;escalation&lt;/strong&gt; package takes dose-finding methods that other authors have provided and gives them a consistent interface.
This makes it simple to add any behaviour to any method, creating a modular Lego-like approach to creating dose-finding designs.
For instance, we can take any dose-selection model and tweak the way it selects the next dose, the way it escalates, de-escalates and stops.
I hope eventually that &lt;strong&gt;escalation&lt;/strong&gt; makes it easy to specify, assess and compare all dose-escalation designs.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;roadmap&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Roadmap&lt;/h2&gt;
&lt;p&gt;Version 0.0.1 has been submitted to CRAN (but as of 2020-02-17, not yet accepted) with the following base dose-finding approaches:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the CRM model from the &lt;a href=&#34;https://CRAN.R-project.org/package=dfcrm&#34;&gt;&lt;code&gt;dfcrm&lt;/code&gt;&lt;/a&gt; package&lt;/li&gt;
&lt;li&gt;the BOIN model from the &lt;a href=&#34;https://CRAN.R-project.org/package=BOIN&#34;&gt;&lt;code&gt;BOIN&lt;/code&gt;&lt;/a&gt; package&lt;/li&gt;
&lt;li&gt;the perennial 3+3 model without dose de-escalation&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and the following optional embellishments:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;don’t skip doses in escalation and/or de-escalation&lt;/li&gt;
&lt;li&gt;stop when dose(s) are too toxic&lt;/li&gt;
&lt;li&gt;stop when &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; patients have been treated in total&lt;/li&gt;
&lt;li&gt;stop when &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; patients have been treated at a particular dose&lt;/li&gt;
&lt;li&gt;use an initial fixed dose-escalation plan&lt;/li&gt;
&lt;li&gt;demand at least &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; patients have been treated at a particular dose before stopping is permitted.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In future versions, the following base dose-finding approaches will probably be added:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the EWOC model from the &lt;a href=&#34;https://CRAN.R-project.org/package=EWOC&#34;&gt;&lt;code&gt;EWOC&lt;/code&gt;&lt;/a&gt; package&lt;/li&gt;
&lt;li&gt;the CRM and EffTox models from the &lt;a href=&#34;https://CRAN.R-project.org/package=trialr&#34;&gt;&lt;code&gt;trialr&lt;/code&gt;&lt;/a&gt; package&lt;/li&gt;
&lt;li&gt;the CRM model from the &lt;a href=&#34;https://CRAN.R-project.org/package=bcrm&#34;&gt;&lt;code&gt;bcrm&lt;/code&gt;&lt;/a&gt; package&lt;/li&gt;
&lt;li&gt;the CRM model from the &lt;a href=&#34;https://CRAN.R-project.org/package=crmPack&#34;&gt;&lt;code&gt;crmPack&lt;/code&gt;&lt;/a&gt; package&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Before I plough into the MCMC methods (trialr, bcrm, crmPack), I want to understand the implications of adding other software to the dependency chain to what at the moment is a very lightweight package.&lt;/p&gt;
&lt;p&gt;In addition to those, I plan to add further behaviours that allow:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stopping under the conditions investigated by &lt;span class=&#34;citation&#34;&gt;Zohar and Chevret (2001)&lt;/span&gt;;&lt;/li&gt;
&lt;li&gt;selecting dose by the CIBP criterion of &lt;span class=&#34;citation&#34;&gt;Mozgunov and Jaki (2020)&lt;/span&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Independent to the work described above, I will add functions that run simulations and calculate dose pathways.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;how-escalation-came-about&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;How escalation came about&lt;/h2&gt;
&lt;p&gt;It had bothered me for several years that it always seemed so difficult to tweak behaviour of dose-finging designs to allow flexible stopping (etc).
In my trials unit, we frequently started with the dfcrm code and then added custom embellishments to achieve the design and behaviour we wanted in each particular trial.
Running simulations or calculating future dose pathways was never as simple as it should have been.
The approach we used of tweaking dfcrm implicitly assumed we needed a more complex dose-fitting function.
And then one night at about 4am when I was neither asleep nor awake, I realised that we needed to daisy-chain the dose-selecting classes together to augment behaviour.
We did not need a more complex dose-fitting function, we needed a flexible way of combining simple functions.
Having used dplyr and tidyverse packages for years now, the &lt;code&gt;%&amp;gt;%&lt;/code&gt; operator seemed the natural solution.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;installation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Once it hits CRAN, install the latest official version with:
install.packages(&amp;quot;escalation&amp;quot;)

# Alternatively, install the latest code at any time from GitHub:
devtools::install_github(&amp;quot;brockk/escalation&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;resources&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Resources&lt;/h2&gt;
&lt;p&gt;&lt;img src=&#34;https://github.com/brockk/escalation/raw/master/man/figures/logo.png&#34; align=&#34;right&#34; height=140/&gt;&lt;/p&gt;
&lt;!-- * [CRAN package page](https://cran.r-project.org/package=escalation) --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/brockk/escalation&#34;&gt;GitHub repo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://brockk.github.io/escalation/&#34;&gt;Documentation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;references&#34; class=&#34;section level2 unnumbered&#34;&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;div id=&#34;refs&#34; class=&#34;references&#34;&gt;
&lt;div id=&#34;ref-Brock2019&#34;&gt;
&lt;p&gt;Brock, Kristian. 2019. “trialr: Bayesian Clinical Trial Designs in R and Stan.” &lt;em&gt;arXiv E-Prints&lt;/em&gt;, June, arXiv:1907.00161.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-Brock2017a&#34;&gt;
&lt;p&gt;Brock, Kristian, Lucinda Billingham, Mhairi Copland, Shamyla Siddique, Mirjana Sirovica, and Christina Yap. 2017. “Implementing the EffTox Dose-Finding Design in the Matchpoint Trial.” &lt;em&gt;BMC Medical Research Methodology&lt;/em&gt; 17 (1): 112. &lt;a href=&#34;https://doi.org/10.1186/s12874-017-0381-x&#34;&gt;https://doi.org/10.1186/s12874-017-0381-x&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-dfcrm&#34;&gt;
&lt;p&gt;Cheung, Ken. 2013. &lt;em&gt;Dfcrm: Dose-Finding by the Continual Reassessment Method&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=dfcrm&#34;&gt;https://CRAN.R-project.org/package=dfcrm&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-liu_bayesian_2015&#34;&gt;
&lt;p&gt;Liu, Suyu, and Ying Yuan. 2015. “Bayesian Optimal Interval Designs for Phase I Clinical Trials.” &lt;em&gt;Journal of the Royal Statistical Society: Series C (Applied Statistics)&lt;/em&gt; 64 (3): 507–23. &lt;a href=&#34;https://doi.org/10.1111/rssc.12089&#34;&gt;https://doi.org/10.1111/rssc.12089&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-mozgunovImprovingSafetyContinual&#34;&gt;
&lt;p&gt;Mozgunov, Pavel, and Thomas Jaki. 2020. “Improving Safety of the Continual Reassessment Method via a Modified Allocation Rule.” &lt;em&gt;Statistics in Medicine&lt;/em&gt;, 1–17. &lt;a href=&#34;https://doi.org/10.1002/sim.8450&#34;&gt;https://doi.org/10.1002/sim.8450&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-OQuigley1990&#34;&gt;
&lt;p&gt;O’Quigley, J, M Pepe, and L Fisher. 1990. “Continual Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.” &lt;em&gt;Biometrics&lt;/em&gt; 46 (1): 33–48. &lt;a href=&#34;https://doi.org/10.2307/2531628&#34;&gt;https://doi.org/10.2307/2531628&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-BOIN&#34;&gt;
&lt;p&gt;Yuan, Ying, and Suyu Liu. 2018. &lt;em&gt;BOIN: Bayesian Optimal Interval (Boin) Design for Single-Agent and Drug- Combination Phase I Clinical Trials&lt;/em&gt;. &lt;a href=&#34;https://CRAN.R-project.org/package=BOIN&#34;&gt;https://CRAN.R-project.org/package=BOIN&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ref-zohar_continual_2001&#34;&gt;
&lt;p&gt;Zohar, Sarah, and Sylvie Chevret. 2001. “The Continual Reassessment Method: Comparison of Bayesian Stopping Rules for Dose-Ranging Studies.” &lt;em&gt;Statistics in Medicine&lt;/em&gt; 20 (19): 2827–43. &lt;a href=&#34;https://doi.org/10.1002/sim.920&#34;&gt;https://doi.org/10.1002/sim.920&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>R Markdown is a miracle for scientific communication and repeatable research</title>
      <link>https://www.kristianbrock.com/post/rmarkdown-in-trials/</link>
      <pubDate>Sun, 19 Jan 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/rmarkdown-in-trials/</guid>
      <description>


&lt;p&gt;At CRCTU, we recently ran our &lt;a href=&#34;https://www.kristianbrock.com/courses/bootcamp/&#34;&gt;bootcamp course&lt;/a&gt; for the first time, a programme of core technical training for newly recruited biostatisticians.&lt;/p&gt;
&lt;p&gt;Clinical trials units are busy centres of research where collaboration is the default.
Being able to visualise data and communicate technical details to others quickly and effectively is important.
Being able to reproduce something you calculated last month is necessary.
R Markdown addresses both of these problems by interweaving prose and code to produce rich, interactive documents in … whatever format you need.&lt;/p&gt;
&lt;p&gt;Here is RStudio explaining better than I could:&lt;/p&gt;
&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;https://player.vimeo.com/video/178485416&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; title=&#34;vimeo video&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;
 &lt;/div&gt;
&lt;/p&gt;
&lt;p&gt;R Markdown is super flexible. Some things I have created in it are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A complete &lt;a href=&#34;https://arxiv.org/pdf/1907.00161.pdf&#34;&gt;journal article&lt;/a&gt;, including abstract, authors and affiliations, keywords, figures and tables with captions, cross-referencing, bibliography &lt;a href=&#34;https://raw.githubusercontent.com/brockk/trialr-jss/master/trialr.Rmd&#34;&gt;(link to source)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Literally &lt;em&gt;this exact webpage&lt;/em&gt; you are reading right now &lt;a href=&#34;https://raw.githubusercontent.com/brockk/brockk-io/master/content/post/rmarkdown-in-trials/index.Rmd&#34;&gt;(link to source)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Interactive tutorials at &lt;a href=&#34;https://rstudio.cloud/project/454702&#34; class=&#34;uri&#34;&gt;https://rstudio.cloud/project/454702&lt;/a&gt;. Look for the Run.R file to launch a tutorial. &lt;a href=&#34;https://raw.githubusercontent.com/brockk/bootcamp/master/inst/tutorials/intro/intro.Rmd&#34;&gt;(link to source)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In each example, the source code is written 100% in R Markdown and then compiled to create the article PDF or the web page or the Word doc or whatever.
To emphasise that point, I have provided a link to the source Rmd file in each instance.&lt;/p&gt;
&lt;p&gt;The R users at CRCTU use R Markdown files to conduct trial analyses and produce DMC reports.
We trained new statisticians in this area because we knew that it is not the kind of thing universities would teach in their MSc programmes.
However, reproducible research is one of the core pillars of our &lt;em&gt;bootcamp&lt;/em&gt; programme and we see R Markdown as the key technology in this area.&lt;/p&gt;
&lt;p&gt;Do you train statisticians in this area at your institution?
Do you want to?
Are you a statistician that wishes they had access to this type of training?
If so, feel free to get in contact and we could bring it to your CTU.&lt;/p&gt;
&lt;p&gt;Also, please fill in our brief questionnaire on how CTUs train statisticians!&lt;/p&gt;
&lt;iframe src=&#34;https://docs.google.com/forms/d/e/1FAIpQLScjzv7bka0qonsyvYpZ-__OiOXThaVfc99JAF5f3JruTEZbYg/viewform?embedded=true&#34; width=&#34;640&#34; height=&#34;1976&#34; frameborder=&#34;0&#34; marginheight=&#34;0&#34; marginwidth=&#34;0&#34;&gt;
Loading…
&lt;/iframe&gt;
&lt;p&gt;Thanks!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>CRM Simulation Checklist</title>
      <link>https://www.kristianbrock.com/post/crm-simulations-checklist/</link>
      <pubDate>Wed, 15 Jan 2020 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/crm-simulations-checklist/</guid>
      <description>&lt;p&gt;During 2019, I was working on simulations using CRM designs in several different trials.
I found I would frequently get the designs mixed up:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;We are targeting 20% toxicity in this trial, right? No, that was the other trial&amp;hellip;we are targeting 33% here&amp;hellip;&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Similarly, once or twice, I got to the stage where I wanted to run simulations only to discover we had not specified some important design aspect, like when the trial should stop.
To bring all the pertinent information to the fore, I wrote a checklist.
I would take the list and fill it out for each trial to ensure I had all the right information before I started simulating.&lt;/p&gt;
&lt;p&gt;Download the checklist as &lt;a href=&#34;https://www.kristianbrock.com/doc/CrmSimulationChecklist-1.0.pdf&#34;&gt;PDF&lt;/a&gt;, &lt;a href=&#34;https://www.kristianbrock.com/doc/CrmSimulationChecklist-1.0.docx&#34;&gt;editable Word version&lt;/a&gt;, or &lt;a href=&#34;https://www.kristianbrock.com/doc/CrmSimulationChecklist-Example-1.0.pdf&#34;&gt;completed example&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&#34;checklist&#34;&gt;Checklist&lt;/h1&gt;
&lt;h3 id=&#34;1-doses-under-investigation&#34;&gt;1. Doses under investigation?&lt;/h3&gt;
&lt;p&gt;Put simply, which doses are you investigating?
And how many are there?
Let&#39;s refer to the number of doses as $n$.
For the plain vanilla CRM, the doses should be fully orderable, meaning it should be possible to unambiguously state that $a &amp;gt; b$ or $a &amp;lt; b$ for each pair of doses $a, b$.
Incidentally, this is also true of the 3+3.
It is easy to inadvertently violate the &lt;em&gt;total orderability&lt;/em&gt; rule when you have combinations (e.g. is 10mg A + 10mb B a greater or lesser dose than 5mg A + 20mg B?) or when you are varying doses and frequencies (e.g. is 20mg of A each day a greater or lesser dose than 100mg of A once per week?).&lt;/p&gt;
&lt;h3 id=&#34;2-target-toxicity-level&#34;&gt;2. Target toxicity level?&lt;/h3&gt;
&lt;p&gt;What probability of dose-limiting toxicity are you targeting?
CRM and 3+3 are toxicity-chasing designs - they will escalate dose until toxicity is seen.
There must be a rationale for why escalation is anticipated to be beneficial to the patient.
So what probability of toxicity are you targeting?
If it is hard to specify an acceptable target, or the target is very low, that might be a sign that CRM and 3+3 are not suitable approaches.&lt;/p&gt;
&lt;h3 id=&#34;3-skeleton&#34;&gt;3. Skeleton?&lt;/h3&gt;
&lt;p&gt;What is your &lt;em&gt;a-priori&lt;/em&gt; expectation of the rate of toxicity at each dose?
This should be a monotonically-increasing vector of probabilities of length $n$.&lt;/p&gt;
&lt;h3 id=&#34;4-starting-dose&#34;&gt;4. Starting dose?&lt;/h3&gt;
&lt;p&gt;Which dose will you start at?
Having a dose or two to de-escalate to might be preferable in case your toxicity expectations are wrong.&lt;/p&gt;
&lt;h3 id=&#34;5-model-type&#34;&gt;5. Model type?&lt;/h3&gt;
&lt;p&gt;There have been various suggestions to model the dose-toxicity curve.
Will you use the empiric approach, or a one parameter logisitic approach, etc?&lt;/p&gt;
&lt;h3 id=&#34;6-model-parameters&#34;&gt;6. Model parameters?&lt;/h3&gt;
&lt;p&gt;Different model types require different parameters and hyperparameters.
E.g. the empiric model shifts the skeleton up and down as DLT outcomes are evaluated in patients, using a single parameter, often called $\beta$.
That parameter needs a prior distribution.
The default prior on $\beta$ in &lt;a href=&#34;https://cran.r-project.org/package=dfcrm&#34;&gt;dfcrm&lt;/a&gt; is $\beta \sim N(0, 1.34)$.
I will let you research why.&lt;/p&gt;
&lt;h3 id=&#34;7-how-to-select-dose&#34;&gt;7. How to select dose?&lt;/h3&gt;
&lt;p&gt;Will you select the dose with estimated DLT probability closest to the target?
Or closest to target without exceeding the target?
Will you permit skipping doses in escalation?
How about de-escalation?&lt;/p&gt;
&lt;h3 id=&#34;8-when-to-stop&#34;&gt;8. When to stop?&lt;/h3&gt;
&lt;p&gt;Trials end&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; - when will your trial end?
What is the maximum sample size?
Do you have a stopping rule for excess toxicity?
Do you want to evaluate a minimum number of patients at the candidate dose before you stop?
Also, check that these constraints do not contradict one another!&lt;/p&gt;
&lt;h3 id=&#34;9-length-of-dlt-assessment-window&#34;&gt;9. Length of DLT assessment window?&lt;/h3&gt;
&lt;p&gt;How long is the DLT assessment window?&lt;/p&gt;
&lt;h2 id=&#34;if-using-non-time-to-event-method&#34;&gt;If using non-time-to-event method:&lt;/h2&gt;
&lt;h3 id=&#34;10-how-to-select-cohort-size&#34;&gt;10. How to select cohort size?&lt;/h3&gt;
&lt;p&gt;Commonly, designs have used fixed cohort sizes of three.
But perhaps you want to use flexible cohort sizes of 2-5 patients, depending on the times at which the patients arrive?
How will you simulate this?&lt;/p&gt;
&lt;h2 id=&#34;if-using-time-to-event-method&#34;&gt;If using time-to-event method:&lt;/h2&gt;
&lt;h3 id=&#34;11-how-to-calculate-weight-of-observation&#34;&gt;11. How to calculate weight of observation?&lt;/h3&gt;
&lt;p&gt;Under the Time-to-Event CRM (TITE-CRM), censored observations of non-DLT are weighted somewhere between 0 and 1.
Logically, the weight should be a non-decreasing function of the length of follow-up.
If DLT is experienced, the weight should be 1.
Several weight functions have been proposed.
A simple option is linear, i.e. 50% of the evaluation period without DLT is considered to be 0.5 non-DLT events.&lt;/p&gt;
&lt;h2 id=&#34;for-simulation&#34;&gt;For simulation:&lt;/h2&gt;
&lt;h3 id=&#34;12-what-is-assumed-true-probdlt&#34;&gt;12. What is assumed true Prob(DLT)?&lt;/h3&gt;
&lt;p&gt;The key simulation parameter, what is the true probability of DLT at each dose?
It will be tempting to choose a true dose-DLT curve that looks similar to your skeleton but do not stop there.
Naturally, a thorough simulation study will look at many true dose-DLT curves, with the sought dose appearing at different positions.
If you have a rule for early stopping, you might want to consider a scenario where the true DLT probabilities are all too high.&lt;/p&gt;
&lt;h2 id=&#34;for-simulation-using-time-to-event-method&#34;&gt;For simulation using time-to-event method:&lt;/h2&gt;
&lt;h3 id=&#34;13-what-is-time-between-patient-arrivals&#34;&gt;13. What is time between patient arrivals?&lt;/h3&gt;
&lt;p&gt;When simulating using the TITE-CRM method, you will need to randomly sample patient arrival times.
For memoryless waiting times, the exponential distribution would do the job.&lt;/p&gt;
&lt;h3 id=&#34;14-what-is-time-between-patient-arrivals&#34;&gt;14. What is time between patient arrivals?&lt;/h3&gt;
&lt;p&gt;Generally in simulation, you sample whether toxicity will happen in a patient given their assigned dose and the associated probability of DLT using a random draw from a Bernoulli distribution.
Once you have established that toxicity occurs in a given patient, you will need to sample the time of the DLT.
How will you do that?
You might assume a constant hazard, for example, and thus use an exponential distribution.
Obviously, if a patient does not experience DLT then their DLT time is infinite.&lt;/p&gt;
&lt;h1 id=&#34;availability-of-software&#34;&gt;Availability of software&lt;/h1&gt;
&lt;p&gt;Having made all these choices (and it is exhausting to even think of all these things), you then have to find or write code to make it happen.
You may find you do not have the time or programming skill to write exactly what you want and opt for an off-the-shelf solution.
Each of &lt;a href=&#34;https://cran.r-project.org/package=dfcrm&#34;&gt;dfcrm&lt;/a&gt;, &lt;a href=&#34;https://cran.r-project.org/package=bcrm&#34;&gt;bcrm&lt;/a&gt;, and &lt;a href=&#34;https://cran.r-project.org/package=crmPack&#34;&gt;crmPack&lt;/a&gt; offer methods for simulating CRM trials, and my very own &lt;a href=&#34;https://www.kristianbrock.com/project/trialr/&#34;&gt;trialr&lt;/a&gt; will have CRM simulation methods soon.
However, each differs in what they offer (that feels like a blog post for another day).
You may discover that no off-the-shelf package does exactly what you want and find yourself tweaking your choices above in light of what is feasible.
It is an iterative process.&lt;/p&gt;
&lt;h3 id=&#34;read-more&#34;&gt;Read more&lt;/h3&gt;
&lt;p&gt;Graham Wheeler and co-authors &lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; wrote a tutorial for designing dose-finding trials using the CRM.
You can read more about that article &lt;a href=&#34;https://www.kristianbrock.com/publication/crm-tutorial/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;footnotes&#34;&gt;Footnotes&lt;/h3&gt;
&lt;section class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;even &lt;a href=&#34;http://www.stampedetrial.org/&#34;&gt;STAMPEDE&lt;/a&gt;, one imagines. &lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34; role=&#34;doc-endnote&#34;&gt;
&lt;p&gt;Wheeler, G.M., Mander, A.P., Bedding, A., Brock, K., Cornelius, V., Grieve, A.P., Jaki, T., Love, S.B., Odondi, L., Weir, C.J., Yap, C., Bond, S.J., 2019. How to design a dose-finding study using the continual reassessment method. BMC Medical Research Methodology 19. &lt;a href=&#34;https://doi.org/10.1186/s12874-018-0638-z&#34;&gt;https://doi.org/10.1186/s12874-018-0638-z&lt;/a&gt; &lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/section&gt;
</description>
    </item>
    
    <item>
      <title>First post</title>
      <link>https://www.kristianbrock.com/post/first-post/first-post/</link>
      <pubDate>Fri, 27 Dec 2019 00:00:00 +0000</pubDate>
      <guid>https://www.kristianbrock.com/post/first-post/first-post/</guid>
      <description>


&lt;p&gt;I have started this site to record things I am working on in R during my duties as an academic clinical trial statistician.&lt;/p&gt;
&lt;p&gt;Fingers crossed.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
